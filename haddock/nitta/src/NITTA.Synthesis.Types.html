<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">{- |
Module      : NITTA.Synthesis.Types
Description : Synthesis tree representation
Copyright   : (c) Aleksandr Penskoi, 2021
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental

Synthesis can be represented as a graph (tree), where each 'Node' describes the
target system 'ModelState' and each 'Edge' synthesis decision.

A synthesis graph is very large and calculating and storing it in memory is very
bad idea. Also, working with synthesis graph usually making from the specific
node, not from the root. As a result, synthesis graph design as a explicit lazy
mutable structure implemented by 'TVar'.

From this point of view, the synthesis process is a finding of the best tree
leaf (lowest process duration for finished synthesis), and the best synthesis
method - a method which directly walks over the tree to the best leaf without
wrong steps.
-}</span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Synthesis.Types</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecisionCls"><span class="hs-identifier">SynthesisDecisionCls</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier">SynthesisDecision</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier">SynthesisState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier">SynthesisMethodConstraints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier">Sid</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier">DefTree</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier">SynthesisMethod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#%3C%3F%3E"><span class="hs-operator">(&lt;?&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#targetUnit"><span class="hs-identifier">targetUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#targetDFG"><span class="hs-identifier">targetDFG</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier">defScore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#mlScoreKeyPrefix"><span class="hs-identifier">mlScoreKeyPrefix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TMVar</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.Split</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Analysis.html"><span class="hs-identifier">NITTA.Intermediate.Analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Analysis.html#ProcessWave"><span class="hs-identifier">ProcessWave</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Networks.Bus.html"><span class="hs-identifier">NITTA.Model.Networks.Bus</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Allocation.html"><span class="hs-identifier">NITTA.Model.Problems.Allocation</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Bind.html"><span class="hs-identifier">NITTA.Model.Problems.Bind</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Dataflow.html"><span class="hs-identifier">NITTA.Model.Problems.Dataflow</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Refactor.html"><span class="hs-identifier">NITTA.Model.Problems.Refactor</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.ViewHelper.html"><span class="hs-identifier">NITTA.Model.Problems.ViewHelper</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html"><span class="hs-identifier">NITTA.Model.ProcessorUnits.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnitTag"><span class="hs-identifier">UnitTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.TargetSystem.html"><span class="hs-identifier">NITTA.Model.TargetSystem</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Time.html"><span class="hs-identifier">NITTA.Model.Time</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.UIBackend.ViewHelperCls.html"><span class="hs-identifier">NITTA.UIBackend.ViewHelperCls</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.Base.html"><span class="hs-identifier">NITTA.Utils.Base</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Default synthesis tree type.</span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="DefTree"><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-var">DefTree</span></a></span></span><span> </span><span id="local-6989586621680270830"><span class="annot"><a href="#local-6989586621680270830"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621680270829"><span class="annot"><a href="#local-6989586621680270829"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680270828"><span class="annot"><a href="#local-6989586621680270828"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680270827"><span class="annot"><a href="#local-6989586621680270827"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.TargetSystem.html#TargetSystem"><span class="hs-identifier hs-type">TargetSystem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Networks.Bus.html#BusNetwork"><span class="hs-identifier hs-type">BusNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270830"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270829"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270828"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270827"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680270830"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270829"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270828"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270827"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680270830"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270829"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270828"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270827"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{- | The synthesis method is a function, which manipulates a synthesis tree. It
receives a node and explores it deeply by IO.
-}</span><span>
</span><span id="line-76"></span><span class="hs-keyword">type</span><span> </span><span id="SynthesisMethod"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-var">SynthesisMethod</span></a></span></span><span> </span><span id="local-6989586621680270825"><span class="annot"><a href="#local-6989586621680270825"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621680270824"><span class="annot"><a href="#local-6989586621680270824"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680270823"><span class="annot"><a href="#local-6989586621680270823"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680270822"><span class="annot"><a href="#local-6989586621680270822"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270825"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270824"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270823"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270822"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270825"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270824"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270823"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270822"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">{- | Shortcut for constraints in signatures of synthesis method functions.
This used to be (VarValTime v x t, UnitTag tag). See below for more info.
-}</span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span id="SynthesisMethodConstraints"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-var">SynthesisMethodConstraints</span></a></span></span><span> </span><span id="local-6989586621680270821"><span class="annot"><a href="#local-6989586621680270821"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621680270820"><span class="annot"><a href="#local-6989586621680270820"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680270819"><span class="annot"><a href="#local-6989586621680270819"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680270818"><span class="annot"><a href="#local-6989586621680270818"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Time.html#VarValTimeJSON"><span class="hs-identifier hs-type">VarValTimeJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270820"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270819"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270818"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680270821"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnitTag"><span class="hs-identifier hs-type">UnitTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270821"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">{- | Synthesis node ID. ID is a relative path, encoded as a sequence of an option
index.
-}</span><span>
</span><span id="line-86"></span><span class="hs-keyword">newtype</span><span> </span><span id="Sid"><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sid"><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Sid separator for @Show Sid@ and @Read Sid@.</span><span>
</span><span id="line-89"></span><span id="sidSep"><span class="annot"><span class="annottext">sidSep :: Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var hs-var">sidSep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270810"><span id="local-6989586621680270813"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621680270806"><span class="annot"><span class="annottext">show :: Sid -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var">sidSep</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span id="local-6989586621680270804"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270804"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. Show a =&gt; [a] -&gt; String
</span><a href="#local-6989586621680270803"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270804"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>            </span><span id="local-6989586621680270803"><span class="annot"><span class="annottext">show' :: [a] -&gt; String
</span><a href="#local-6989586621680270803"><span class="hs-identifier hs-var hs-var">show'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-96"></span><span>            </span><span class="annot"><a href="#local-6989586621680270803"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680270797"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680270797"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680270796"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680270796"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var">sidSep</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680270797"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; String
</span><a href="#local-6989586621680270803"><span class="hs-identifier hs-var">show'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680270796"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270789"><span id="local-6989586621680270791"><span id="local-6989586621680270793"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621680270777"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS Sid
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680270775"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680270775"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680270775"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var">sidSep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">readsPrec</span></span><span> </span><span id="local-6989586621680270774"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680270774"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680270773"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680270773"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680270772"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680270772"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680270773"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var">sidSep</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680270771"><span class="annot"><span class="annottext">is :: [[(Int, String)]]
</span><a href="#local-6989586621680270771"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Read a =&gt; Int -&gt; ReadS a
</span><span class="hs-identifier hs-var">readsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680270774"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">splitOn</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="NITTA.Synthesis.Types.html#sidSep"><span class="hs-identifier hs-var">sidSep</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680270772"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[[(Int, String)]]
</span><a href="#local-6989586621680270771"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[(Int, String)]]
</span><a href="#local-6989586621680270771"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">readsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621680270762"><span class="annot"><span class="annottext">def :: Sid
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270756"><span id="local-6989586621680270758"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span id="local-6989586621680270752"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270752"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680270751"><span class="annot"><span class="annottext">&lt;&gt; :: Sid -&gt; Sid -&gt; Sid
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span id="local-6989586621680270750"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270750"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270752"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680270750"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270744"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621680270742"><span class="annot"><span class="annottext">mempty :: Sid
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621680270740"><span class="annot"><span class="annottext">mappend :: Sid -&gt; Sid -&gt; Sid
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270733"><span id="local-6989586621680270735"><span id="local-6989586621680270737"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621680270726"><span class="annot"><span class="annottext">toJSON :: Sid -&gt; Value
</span><a href="#local-6989586621680270726"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621680270725"><span class="annot"><span class="annottext">Sid
</span><a href="#local-6989586621680270725"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Sid
</span><a href="#local-6989586621680270725"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680270720"><span id="local-6989586621680270722"><span class="annot"><span class="hs-identifier hs-type">FromHttpApiData</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621680270717"><span class="annot"><span class="annottext">parseUrlPiece :: Text -&gt; Either Text Sid
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseUrlPiece</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. Read a =&gt; Text -&gt; a
</span><a href="NITTA.Utils.Base.html#readText"><span class="hs-identifier hs-var">readText</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | Synthesis tree</span><span>
</span><span id="line-124"></span><span class="hs-keyword">data</span><span> </span><span id="Tree"><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-var">Tree</span></a></span></span><span> </span><span id="local-6989586621680271055"><span class="annot"><a href="#local-6989586621680271055"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680271054"><span class="annot"><a href="#local-6989586621680271054"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621680271053"><span class="annot"><a href="#local-6989586621680271053"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680271052"><span class="annot"><a href="#local-6989586621680271052"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680271051"><span class="annot"><a href="#local-6989586621680271051"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Tree"><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-var">Tree</span></a></span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sID"><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var hs-var">sID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sState"><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var hs-var">sState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271054"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271053"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271052"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271051"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sDecision"><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var hs-var">sDecision</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271054"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271053"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271052"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271051"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680271055"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSubForestVar"><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; TMVar [Tree m tag v x t]
</span><a href="NITTA.Synthesis.Types.html#sSubForestVar"><span class="hs-identifier hs-var hs-var">sSubForestVar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TMVar</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271054"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271053"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271052"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271051"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- ^ lazy mutable field with different synthesis options and sub nodes</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="isLeaf"><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Types.html#isLeaf"><span class="hs-identifier hs-var hs-var">isLeaf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="isComplete"><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Types.html#isComplete"><span class="hs-identifier hs-var hs-var">isComplete</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="targetUnit"><span class="annot"><span class="annottext">targetUnit :: Tree (TargetSystem c tag v x t) tag v x t -&gt; c
</span><a href="NITTA.Synthesis.Types.html#targetUnit"><span class="hs-identifier hs-var hs-var">targetUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u tag v x t. TargetSystem u tag v x t -&gt; u
</span><a href="NITTA.Model.TargetSystem.html#mUnit"><span class="hs-identifier hs-var">mUnit</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; m
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var">sTarget</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span>
</span><span id="line-135"></span><span id="targetDFG"><span class="annot"><span class="annottext">targetDFG :: Tree (TargetSystem u tag v x t) tag v x t -&gt; DataFlowGraph v x
</span><a href="NITTA.Synthesis.Types.html#targetDFG"><span class="hs-identifier hs-var hs-var">targetDFG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u tag v x t. TargetSystem u tag v x t -&gt; DataFlowGraph v x
</span><a href="NITTA.Model.TargetSystem.html#mDataFlowGraph"><span class="hs-identifier hs-var">mDataFlowGraph</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; m
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var">sTarget</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">data</span><span> </span><span id="SynthesisDecision"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-var">SynthesisDecision</span></a></span></span><span> </span><span id="local-6989586621680270703"><span class="annot"><a href="#local-6989586621680270703"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621680270702"><span class="annot"><a href="#local-6989586621680270702"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621680270700"><span id="local-6989586621680270701"><span id="Root"><span class="annot"><a href="NITTA.Synthesis.Types.html#Root"><span class="hs-identifier hs-var">Root</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270701"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270700"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621680270696"><span id="local-6989586621680270697"><span id="local-6989586621680270698"><span id="local-6989586621680270980"><span id="local-6989586621680270981"><span id="SynthesisDecision"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-var">SynthesisDecision</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680270698"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecisionCls"><span class="hs-identifier hs-type">SynthesisDecisionCls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270981"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270980"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270697"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270696"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270698"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680270696"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680270698"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.UIBackend.ViewHelperCls.html#Viewable"><span class="hs-identifier hs-type">Viewable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270696"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="NITTA.Model.Problems.ViewHelper.html#DecisionView"><span class="hs-identifier hs-type">DecisionView</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">{</span><span id="option"><span class="annot"><span class="annottext">()
</span><a href="NITTA.Synthesis.Types.html#option"><span class="hs-identifier hs-var hs-var">option</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270697"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span id="decision"><span class="annot"><span class="annottext">()
</span><a href="NITTA.Synthesis.Types.html#decision"><span class="hs-identifier hs-var hs-var">decision</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270696"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span id="metrics"><span class="annot"><span class="annottext">()
</span><a href="NITTA.Synthesis.Types.html#metrics"><span class="hs-identifier hs-var hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270698"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span id="scores"><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Map Text Float
</span><a href="NITTA.Synthesis.Types.html#scores"><span class="hs-identifier hs-var hs-var">scores</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270981"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270980"><span class="hs-identifier hs-type">m</span></a></span></span></span></span></span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="mlScoreKeyPrefix"><span class="annot"><span class="annottext">mlScoreKeyPrefix :: a
</span><a href="NITTA.Synthesis.Types.html#mlScoreKeyPrefix"><span class="hs-identifier hs-var hs-var">mlScoreKeyPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;ml_&quot;</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621680270967"><span id="local-6989586621680270968"><span class="annot"><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-type">defScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270968"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270967"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span></span></span><span>
</span><span id="line-147"></span><span id="defScore"><span class="annot"><span class="annottext">defScore :: forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var hs-var">defScore</span></a></span></span><span> </span><span id="local-6989586621680270678"><span class="annot"><span class="annottext">SynthesisDecision ctx m
</span><a href="#local-6989586621680270678"><span class="hs-identifier hs-var">sDecision</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680270677"><span class="annot"><span class="annottext">allScores :: Map Text Float
</span><a href="#local-6989586621680270677"><span class="hs-identifier hs-var hs-var">allScores</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Map Text Float
</span><a href="NITTA.Synthesis.Types.html#scores"><span class="hs-identifier hs-var">scores</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisDecision ctx m
</span><a href="#local-6989586621680270678"><span class="hs-identifier hs-var">sDecision</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621680270676"><span class="annot"><span class="annottext">mlScores :: [(Text, Float)]
</span><a href="#local-6989586621680270676"><span class="hs-identifier hs-var hs-var">mlScores</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. IsString a =&gt; a
</span><a href="NITTA.Synthesis.Types.html#mlScoreKeyPrefix"><span class="hs-identifier hs-var">mlScoreKeyPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">Map Text Float
</span><a href="#local-6989586621680270677"><span class="hs-identifier hs-var">allScores</span></a></span><span>
</span><span id="line-150"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Text, Float)]
</span><a href="#local-6989586621680270676"><span class="hs-identifier hs-var">mlScores</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Text Float
</span><a href="#local-6989586621680270677"><span class="hs-identifier hs-var">allScores</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">M.!</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680270673"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680270673"><span class="hs-identifier hs-var">_key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680270672"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680270672"><span class="hs-identifier hs-var">mlScore</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Float)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680270672"><span class="hs-identifier hs-var">mlScore</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">class</span><span> </span><span id="SynthesisDecisionCls"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecisionCls"><span class="hs-identifier hs-var">SynthesisDecisionCls</span></a></span></span><span> </span><span id="local-6989586621680270671"><span class="annot"><a href="#local-6989586621680270671"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621680270670"><span class="annot"><a href="#local-6989586621680270670"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680270669"><span class="annot"><a href="#local-6989586621680270669"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span id="local-6989586621680270668"><span class="annot"><a href="#local-6989586621680270668"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621680270667"><span class="annot"><a href="#local-6989586621680270667"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680270671"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270669"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270670"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270668"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270667"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>    </span><span id="decisions"><span class="annot"><a href="NITTA.Synthesis.Types.html#decisions"><span class="hs-identifier hs-type">decisions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270671"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270669"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680270668"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680270670"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>    </span><span id="parameters"><span class="annot"><a href="NITTA.Synthesis.Types.html#parameters"><span class="hs-identifier hs-type">parameters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270671"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270669"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270668"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270667"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span id="estimate"><span class="annot"><a href="NITTA.Synthesis.Types.html#estimate"><span class="hs-identifier hs-type">estimate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680270671"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270669"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270668"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680270667"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="SynthesisState"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-var">SynthesisState</span></a></span></span><span> </span><span id="local-6989586621680271001"><span class="annot"><a href="#local-6989586621680271001"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680271000"><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621680270999"><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680270998"><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680270997"><span class="annot"><a href="#local-6989586621680270997"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SynthesisState"><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-var">SynthesisState</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sParent"><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; Maybe (Tree m tag v x t)
</span><a href="NITTA.Synthesis.Types.html#sParent"><span class="hs-identifier hs-var hs-var">sParent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271001"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270997"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sTarget"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; m
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var hs-var">sTarget</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680271001"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sAllocationOptions"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [Allocation tag]
</span><a href="NITTA.Synthesis.Types.html#sAllocationOptions"><span class="hs-identifier hs-var hs-var">sAllocationOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Allocation.html#Allocation"><span class="hs-identifier hs-type">Allocation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- ^ PU allocation options cache</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sBindOptions"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [Bind tag v x]
</span><a href="NITTA.Synthesis.Types.html#sBindOptions"><span class="hs-identifier hs-var hs-var">sBindOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Bind.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- ^ bind options cache</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sResolveDeadlockOptions"><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [ResolveDeadlock v x]
</span><a href="NITTA.Synthesis.Types.html#sResolveDeadlockOptions"><span class="hs-identifier hs-var hs-var">sResolveDeadlockOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Refactor.ResolveDeadlock.html#ResolveDeadlock"><span class="hs-identifier hs-type">ResolveDeadlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sOptimizeAccumOptions"><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [OptimizeAccum v x]
</span><a href="NITTA.Synthesis.Types.html#sOptimizeAccumOptions"><span class="hs-identifier hs-var hs-var">sOptimizeAccumOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Refactor.OptimizeAccum.html#OptimizeAccum"><span class="hs-identifier hs-type">OptimizeAccum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sConstantFoldingOptions"><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [ConstantFolding v x]
</span><a href="NITTA.Synthesis.Types.html#sConstantFoldingOptions"><span class="hs-identifier hs-var hs-var">sConstantFoldingOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Refactor.ConstantFolding.html#ConstantFolding"><span class="hs-identifier hs-type">ConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sBreakLoopOptions"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [BreakLoop v x]
</span><a href="NITTA.Synthesis.Types.html#sBreakLoopOptions"><span class="hs-identifier hs-var hs-var">sBreakLoopOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Refactor.BreakLoop.html#BreakLoop"><span class="hs-identifier hs-type">BreakLoop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sDataflowOptions"><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [DataflowSt tag v (TimeConstraint t)]
</span><a href="NITTA.Synthesis.Types.html#sDataflowOptions"><span class="hs-identifier hs-var hs-var">sDataflowOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.Problems.Dataflow.html#DataflowSt"><span class="hs-identifier hs-type">DataflowSt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Time.html#TimeConstraint"><span class="hs-identifier hs-type">TimeConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270997"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- ^ dataflow options cache</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bindingAlternative"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Map (F v x) [tag]
</span><a href="NITTA.Synthesis.Types.html#bindingAlternative"><span class="hs-identifier hs-var hs-var">bindingAlternative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- ^ a map from functions to possible processor unit tags</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="possibleDeadlockBinds"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Set (F v x)
</span><a href="NITTA.Synthesis.Types.html#possibleDeadlockBinds"><span class="hs-identifier hs-var hs-var">possibleDeadlockBinds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- ^ a function set, which binding may cause dead lock</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bindWaves"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Map v Int
</span><a href="NITTA.Synthesis.Types.html#bindWaves"><span class="hs-identifier hs-var hs-var">bindWaves</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">{- ^ if algorithm will be represented as a graph, where nodes -
    variables of not bound functions, edges - casuality, wave is a
    minimal number of a step from an initial node to selected
    -}</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="processWaves"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [ProcessWave v x]
</span><a href="NITTA.Synthesis.Types.html#processWaves"><span class="hs-identifier hs-var hs-var">processWaves</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Intermediate.Analysis.html#ProcessWave"><span class="hs-identifier hs-type">ProcessWave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680270998"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- ^ Execution waves of the algorithm. See detailed description in NITTA.Intermediate.Analysis module.</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="numberOfProcessWaves"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Int
</span><a href="NITTA.Synthesis.Types.html#numberOfProcessWaves"><span class="hs-identifier hs-var hs-var">numberOfProcessWaves</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- ^ Number of execution waves of the algorithm.</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="numberOfDataflowOptions"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Int
</span><a href="NITTA.Synthesis.Types.html#numberOfDataflowOptions"><span class="hs-identifier hs-var hs-var">numberOfDataflowOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- ^ number of dataflow options</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="transferableVars"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Set v
</span><a href="NITTA.Synthesis.Types.html#transferableVars"><span class="hs-identifier hs-var hs-var">transferableVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621680270999"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">{- ^ a variable set, which can be transferred on the current
    synthesis step
    -}</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="unitWorkloadInFunction"><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; Map tag Int
</span><a href="NITTA.Synthesis.Types.html#unitWorkloadInFunction"><span class="hs-identifier hs-var hs-var">unitWorkloadInFunction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680271000"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- ^ dictionary with number of bound functions for each unit</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- * Utils</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="%3C%3F%3E"><span class="annot"><span class="annottext">&lt;?&gt; :: Bool -&gt; p -&gt; p
</span><a href="NITTA.Synthesis.Types.html#%3C%3F%3E"><span class="hs-operator hs-var hs-var">&lt;?&gt;</span></a></span></span><span> </span><span id="local-6989586621680270644"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680270644"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680270644"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#%3C%3F%3E"><span class="hs-operator hs-var">&lt;?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-199"></span></pre></body></html>