<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- All extensions should be enabled explicitly due to doctest in this module.</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-- TODO: A promising direction for the improvement is the implementation of the</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- accumulator into it. It allows multiplying an arbitrary number of arguments,</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- which will reduce the number of data transactions on the bus when multiplying</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- more than two variables by one function.</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- TODO: Add assertion, which checks that all synthesis decision compliant</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- available options.</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">{- |
Module      : NITTA.Model.ProcessorUnits.Multiplier
Description :
Copyright   : (c) Aleksandr Penskoi, 2020
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental

= Processor unit

A processor unit (PU) can be used for:

- data storage and processing;
- interaction with the periphery (IO);
- control of a NITTA processor (special case).

There are characterized by complicated behavior with:

- multifunctionality;
- internal parallelism;
- superscalar;
- pipelining;
- availability of internal resources.

The multiplier PU is one of the simplest processors because it realizes only
one function with sequence evaluation
('NITTA.Intermediate.Functions.Multiply'). Processor behavior in a specific
application is determined by the applied algorithm
('NITTA.Intermediate.DataFlow').

Any PU may include three components:

- hardware - set of prepared or automatically generated hardware descriptions
  (@\/hdl\/multiplier@);

- software - set of binary files that determine:

    - initial state and setting ;

    - a control program;

- PU model - CAD component that implements PU support (hardware and software
  generation, instance generation, computation process scheduling, testing
  environment, etc.).

All three components are hardly related to each other and needed to comply
with each other strictly. For a deeper understanding, a PU developer should
understand all of its components. The multiplier model will be described
above.

== Processor unit model

A model purpose is &quot;teaching&quot; CAD how to work with the PU:

- Which functions can be evaluated by PU? (see
  'NITTA.Model.ProcessorUnits.Types.ProcessorUnit')?

- How to control PU for evaluating specific functions (see
  'NITTA.Model.ProcessorUnits.Types.ProcessorUnit',
  'NITTA.Model.ProcessorUnits.Types.Controllable')?

- How to translating instructions to microcode (see
  'NITTA.Model.ProcessorUnits.Types.UnambiguouslyDecode')?

- What are the options of PU synthesis decision available? (see
  'NITTA.Model.Problems.Types.ProcessorUnit',
  'NITTA.Model.Problems.Types.EndpointDT'):

    - push variable to the PU ('NITTA.Model.Problems.Endpoint.Target');

    - pull at least one variable from the PU ('NITTA.Model.Problems.Endpoint.Source').

The basis of a PU model is a data structure that represents:

- PU state during computation process scheduling;

- process description (full or fragment), which can be translated to microcode.

Exactly around this data structure, all algorithmic part of the PU model is
developed. The types of the following variables parametrize the data structure:

- @v@ - variable id (usually 'String');

- @x@ - a type of processed value (see 'NITTA.Intermediate.Value.Val');

- @t@ - time moment id (usually 'Int').

= Multiplier processor unit

The multiplier processor unit can evaluate the following function type:

- 'NITTA.Intermediate.Functions.Multiply'.

Only one function can be processed in one moment, and its execution cannot be
interrupted.

This module should be considered as a tutorial for the development of other
models of processor units. Its source code is written almost in literature
style, so we recommend to continue reading within the source code.

== Interaction with multiplier processor unit

We will consider the example of the computation process scheduling for one
function. To do this, we need to start GHCi interpreter by executing `stack
repl` command from the project directory. After that:

@
&gt; :l NITTA.Model.ProcessorUnits.Multiplier
[ 1 of 30] Compiling NITTA.Intermediate.Value ( UserspenskoiDocumentsnitta-corpnittasrcNITTAIntermediate/Value.hs, interpreted )
[ 2 of 30] Compiling NITTA.Intermediate.Variable ( UserspenskoiDocumentsnitta-corpnittasrcNITTAIntermediate/Variable.hs, interpreted )
[ 3 of 30] Compiling NITTA.Intermediate.Types ( UserspenskoiDocumentsnitta-corpnittasrcNITTAIntermediate/Types.hs, interpreted )
[ 4 of 30] Compiling NITTA.Model.Problems.Binding ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProblemsBinding.hs, interpreted )
[ 5 of 30] Compiling NITTA.Model.Types ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModel/Types.hs, interpreted )
[ 6 of 30] Compiling NITTA.Model.Problems.Endpoint ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProblemsEndpoint.hs, interpreted )
[ 7 of 30] Compiling NITTA.Model.Problems.Dataflow ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProblemsDataflow.hs, interpreted )
[ 8 of 30] Compiling NITTA.Project.Types ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProject/Types.hs, interpreted )
[ 9 of 30] Compiling NITTA.Utils.Base ( UserspenskoiDocumentsnitta-corpnittasrcNITTAUtils/Base.hs, interpreted )
[10 of 30] Compiling NITTA.Intermediate.Functions.Accum ( UserspenskoiDocumentsnitta-corpnittasrcNITTAIntermediateFunctionsAccum.hs, interpreted )
[11 of 30] Compiling NITTA.Intermediate.Functions ( UserspenskoiDocumentsnitta-corpnittasrcNITTAIntermediate/Functions.hs, interpreted )
[12 of 30] Compiling NITTA.Model.Problems.Refactor ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProblemsRefactor.hs, interpreted )
[13 of 30] Compiling NITTA.Model.Problems.Whole ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProblemsWhole.hs, interpreted )
[14 of 30] Compiling NITTA.Model.Problems ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModel/Problems.hs, interpreted )
[15 of 30] Compiling NITTA.Utils.CodeFormat ( UserspenskoiDocumentsnitta-corpnittasrcNITTAUtils/CodeFormat.hs, interpreted )
[16 of 30] Compiling NITTA.Model.ProcessorUnits.Types ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProcessorUnitsTypes.hs, interpreted )
[17 of 30] Compiling NITTA.Utils      ( UserspenskoiDocumentsnitta-corpnittasrcNITTAUtils.hs, interpreted )
[18 of 30] Compiling NITTA.Project.VerilogSnippets ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProject/Snippets.hs, interpreted )
[19 of 30] Compiling NITTA.Project.Implementation ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProject/Implementation.hs, interpreted )
[20 of 30] Compiling NITTA.Project.Parts.Utils ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProjectPartsUtils.hs, interpreted )
[21 of 30] Compiling NITTA.Project.TestBench ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProjectPartsTestBench.hs, interpreted )
[22 of 30] Compiling NITTA.Project.Parts.TargetSystem ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProjectPartsTargetSystem.hs, interpreted )
[23 of 30] Compiling NITTA.Project.Parts.Icarus ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProjectPartsIcarus.hs, interpreted )
[24 of 30] Compiling NITTA.Model.Networks.Types ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelNetworksTypes.hs, interpreted )
[25 of 30] Compiling NITTA.Utils.ProcessDescription ( UserspenskoiDocumentsnitta-corpnittasrcNITTAUtils/ProcessDescription.hs, interpreted )
[26 of 30] Compiling NITTA.Model.Networks.Bus ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelNetworksBus.hs, interpreted )
[27 of 30] Compiling NITTA.Project.Parts.Quartus ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProjectPartsQuartus.hs, interpreted )
[28 of 30] Compiling NITTA.Project.Utils ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProject/Utils.hs, interpreted )
[29 of 30] Compiling NITTA.Project    ( UserspenskoiDocumentsnitta-corpnittasrcNITTAProject.hs, interpreted )
[30 of 30] Compiling NITTA.Model.ProcessorUnits.Multiplier ( UserspenskoiDocumentsnitta-corpnittasrcNITTAModelProcessorUnitsMultiplier.hs, interpreted )
Ok, 30 modules loaded.
&gt; :module +NITTA.Model.ProcessorUnits.Types NITTA.Intermediate.Functions Numeric.Interval.NonEmpty Data.Set Prettyprinter.Render.Text
&gt; :set prompt &quot;ESC[34m&#955;&gt; ESC[m&quot;
@

Now create the function and multiplier model initial state. Unfortunately, it
is not enough information for GHC deduction of its type, so let's define its
implicitly.

&gt;&gt;&gt; :module +Prettyprinter.Render.Text
&gt;&gt;&gt; let f = F.multiply &quot;a&quot; &quot;b&quot; [&quot;c&quot;, &quot;d&quot;] :: F String Int
&gt;&gt;&gt; f
a * b = c = d
&gt;&gt;&gt; let st0 = multiplier True :: Multiplier String Int Int
&gt;&gt;&gt; putDoc $ pretty st0
Multiplier:
    remain: []
    targets: []
    sources: []
    currentWork: Nothing
    isMocked: True
    Process:
        steps:
        relations:
        nextTick: 0
        nextUid: 0
&gt;&gt;&gt; endpointOptions st0
[]

Bind a function to the multiplier unit. This operation could be executed at
any time of working with a model, including when a computation process is
fully scheduled (new work can be added). The main rules are: 1) if work is
fully scheduled, then it is necessary to perform it, and any part of it
cannot be &quot;lost&quot; inside the model; 2) if a unit has its internal resources,
there should be enough to finish schedule, even it is inefficient.

&gt;&gt;&gt; let Right st1 = tryBind f st0
&gt;&gt;&gt; putDoc $ pretty st1
Multiplier:
    remain: [a * b = c = d]
    targets: []
    sources: []
    currentWork: Nothing
    isMocked: True
    Process:
        steps:
        relations:
        nextTick: 0
        nextUid: 0
&gt;&gt;&gt; endpointOptions st1
[?Target a@(0..INF /P 1..INF),?Target b@(0..INF /P 1..INF)]

As we can see, after binding, we have two different options of computational
process scheduling that match different argument loading sequences: @a@ or
@b@. We can see that they are similar from an execution sequence point of
view: loading can be started from 0 tick or after an arbitrary delay; for
loading of one argument needed only one tick, but it can continue for an
arbitrary time. Choose the variant.

&gt;&gt;&gt; let st2 = endpointDecision st1 $ EndpointSt (Target &quot;a&quot;) (0...2)
&gt;&gt;&gt; putDoc $ pretty st2
Multiplier:
    remain: []
    targets: [&quot;b&quot;]
    sources: [&quot;c&quot;,&quot;d&quot;]
    currentWork: Just a * b = c = d
    isMocked: True
    Process:
        steps:
            0) Step {pID = 0, pInterval = 0 ... 2, pDesc = Endpoint: Target a}
            1) Step {pID = 1, pInterval = 0 ... 2, pDesc = Instruction: Load}
        relations:
            0) Vertical {vUp = 0, vDown = 1}
        nextTick: 3
        nextUid: 2
&gt;&gt;&gt; mapM_ print $ endpointOptions st2
?Target b@(3..INF /P 1..INF)
&gt;&gt;&gt; let st3 = endpointDecision st2 $ EndpointSt (Target &quot;b&quot;) (3...3)
&gt;&gt;&gt; putDoc $ pretty st3
Multiplier:
    remain: []
    targets: []
    sources: [&quot;c&quot;,&quot;d&quot;]
    currentWork: Just a * b = c = d
    isMocked: True
    Process:
        steps:
            0) Step {pID = 0, pInterval = 0 ... 2, pDesc = Endpoint: Target a}
            1) Step {pID = 1, pInterval = 0 ... 2, pDesc = Instruction: Load}
            2) Step {pID = 2, pInterval = 3 ... 3, pDesc = Endpoint: Target b}
            3) Step {pID = 3, pInterval = 3 ... 3, pDesc = Instruction: Load}
        relations:
            0) Vertical {vUp = 2, vDown = 3}
            1) Vertical {vUp = 0, vDown = 1}
        nextTick: 4
        nextUid: 4
&gt;&gt;&gt; mapM_ print $ endpointOptions st3
?Source c,d@(6..INF /P 1..INF)

After loading both arguments, we can see that the next option is unloading
@c@ and @d@ variables. Note, these variables can be unloaded either
concurrently or sequentially (for details, see how the multiplier works
inside). Consider the second option:

&gt;&gt;&gt; let st4 = endpointDecision st3 $ EndpointSt (Source $ S.fromList [&quot;c&quot;]) (6...6)
&gt;&gt;&gt; putDoc $ pretty st4
Multiplier:
    remain: []
    targets: []
    sources: [&quot;d&quot;]
    currentWork: Just a * b = c = d
    isMocked: True
    Process:
        steps:
            0) Step {pID = 0, pInterval = 0 ... 2, pDesc = Endpoint: Target a}
            1) Step {pID = 1, pInterval = 0 ... 2, pDesc = Instruction: Load}
            2) Step {pID = 2, pInterval = 3 ... 3, pDesc = Endpoint: Target b}
            3) Step {pID = 3, pInterval = 3 ... 3, pDesc = Instruction: Load}
            4) Step {pID = 4, pInterval = 6 ... 6, pDesc = Endpoint: Source c}
            5) Step {pID = 5, pInterval = 6 ... 6, pDesc = Instruction: Out}
        relations:
            0) Vertical {vUp = 4, vDown = 5}
            1) Vertical {vUp = 2, vDown = 3}
            2) Vertical {vUp = 0, vDown = 1}
        nextTick: 7
        nextUid: 6
&gt;&gt;&gt; mapM_ print $ endpointOptions st4
?Source d@(7..INF /P 1..INF)
&gt;&gt;&gt; let st5 = endpointDecision st4 $ EndpointSt (Source $ S.fromList [&quot;d&quot;]) (7...7)
&gt;&gt;&gt; putDoc $ pretty st5
Multiplier:
    remain: []
    targets: []
    sources: []
    currentWork: Nothing
    isMocked: True
    Process:
        steps:
            0) Step {pID = 0, pInterval = 0 ... 2, pDesc = Endpoint: Target a}
            1) Step {pID = 1, pInterval = 0 ... 2, pDesc = Instruction: Load}
            2) Step {pID = 2, pInterval = 3 ... 3, pDesc = Endpoint: Target b}
            3) Step {pID = 3, pInterval = 3 ... 3, pDesc = Instruction: Load}
            4) Step {pID = 4, pInterval = 6 ... 6, pDesc = Endpoint: Source c}
            5) Step {pID = 5, pInterval = 6 ... 6, pDesc = Instruction: Out}
            6) Step {pID = 6, pInterval = 7 ... 7, pDesc = Endpoint: Source d}
            7) Step {pID = 7, pInterval = 7 ... 7, pDesc = Instruction: Out}
            8) Step {pID = 8, pInterval = 0 ... 7, pDesc = Intermediate: a * b = c = d}
        relations:
            0) Vertical {vUp = 8, vDown = 6}
            1) Vertical {vUp = 8, vDown = 4}
            2) Vertical {vUp = 8, vDown = 2}
            3) Vertical {vUp = 8, vDown = 0}
            4) Vertical {vUp = 6, vDown = 7}
            5) Vertical {vUp = 4, vDown = 5}
            6) Vertical {vUp = 2, vDown = 3}
            7) Vertical {vUp = 0, vDown = 1}
        nextTick: 8
        nextUid: 9
&gt;&gt;&gt; endpointOptions st5
[]

All options of computing process scheduling are run out. All bound functions
are planned. Further microcode can be generated, which can be organizing the
described computational process on the multiplier.
-}</span><span>
</span><span id="line-328"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Model.ProcessorUnits.Multiplier</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#multiplier"><span class="hs-identifier">multiplier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier">Multiplier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier">Ports</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier">IOPorts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-333"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-337"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-339"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-340"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.Interpolate</span></span><span>
</span><span id="line-341"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.ToString</span></span><span>
</span><span id="line-342"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html"><span class="hs-identifier">NITTA.Intermediate.Functions</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-343"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-344"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.html"><span class="hs-identifier">NITTA.Model.Problems</span></a></span><span>
</span><span id="line-345"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html"><span class="hs-identifier">NITTA.Model.ProcessorUnits.Types</span></a></span><span>
</span><span id="line-346"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Time.html"><span class="hs-identifier">NITTA.Model.Time</span></a></span><span>
</span><span id="line-347"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.html"><span class="hs-identifier">NITTA.Project</span></a></span><span>
</span><span id="line-348"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.html"><span class="hs-identifier">NITTA.Utils</span></a></span><span>
</span><span id="line-349"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.ProcessDescription.html"><span class="hs-identifier">NITTA.Utils.ProcessDescription</span></a></span><span>
</span><span id="line-350"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Interval.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">inf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(...)</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">{- | It is a PU model state representation, which describes each state of
synthesis model for that PU.
-}</span><span>
</span><span id="line-356"></span><span class="hs-keyword">data</span><span> </span><span id="Multiplier"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-var">Multiplier</span></a></span></span><span> </span><span id="local-6989586621680367708"><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680367707"><span class="annot"><a href="#local-6989586621680367707"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680367706"><span class="annot"><a href="#local-6989586621680367706"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Multiplier"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-var">Multiplier</span></a></span></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aremain%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aremain%3AMultiplier"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367707"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-comment">{- ^ List of the assigned but not processed functions. To execute a
    function:

    - removing the function from this list;

    - transfering information from function to 'targets' and 'sources'
    fields.

    An assigned function can be executed in random order.
    -}</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Atargets%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-comment">{- ^ List of variables, which is needed to push to the PU for current
    function evaluation.
    -}</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Asources%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">{- ^ List of variables, which is needed to pull from PU for current
    function evaluation. Pull order is arbitrary. All pulled variables
    correspond to the same value (same result).
    -}</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcurrentWork%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var hs-var">currentWork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367707"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-comment">-- ^ Current work, if some function is executed.</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aprocess_%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aprocess_%3AMultiplier"><span class="hs-identifier hs-var hs-var">process_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367706"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367708"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367707"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367706"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-comment">{- ^ Description of scheduled computation process
    ('NITTA.Model.ProcessorUnits.Types').
    -}</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AisMocked%3AMultiplier"><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AisMocked%3AMultiplier"><span class="hs-identifier hs-var hs-var">isMocked</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-comment">{- ^ HDL implementation of PU contains a multiplier IP core from Altera.
    Icarus Verilog can not simulate it. If `isMocked` is set, a target
    system will be contained non-synthesizable implementation of that
    IP-core.
    -}</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367229"><span id="local-6989586621680367678"><span id="local-6989586621680367679"><span id="local-6989586621680367680"><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367680"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367679"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367678"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367680"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367679"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367678"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621680367163"><span class="annot"><span class="annottext">pretty :: forall ann. Multiplier v x t -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680367161"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680367161"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367160"><span class="annot"><span class="annottext">[v]
targets :: [v]
$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680367160"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367159"><span class="annot"><span class="annottext">[v]
sources :: [v]
$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680367159"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367158"><span class="annot"><span class="annottext">Maybe (F v x)
currentWork :: Maybe (F v x)
$sel:currentWork:Multiplier :: forall v x t. Multiplier v x t -&gt; Maybe (F v x)
</span><a href="#local-6989586621680367158"><span class="hs-identifier hs-var hs-var">currentWork</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367157"><span class="annot"><span class="annottext">Process t (StepInfo v x t)
process_ :: Process t (StepInfo v x t)
$sel:process_:Multiplier :: forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="#local-6989586621680367157"><span class="hs-identifier hs-var hs-var">process_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367156"><span class="annot"><span class="annottext">Bool
isMocked :: Bool
$sel:isMocked:Multiplier :: forall v x t. Multiplier v x t -&gt; Bool
</span><a href="#local-6989586621680367156"><span class="hs-identifier hs-var hs-var">isMocked</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="">[__i|
            Multiplier:
                remain: #{ remain }
                targets: #{ map toString targets }
                sources: #{ map toString sources }
                currentWork: #{ currentWork }
                isMocked: #{ isMocked }
                #{ nest 4 $ pretty process_ }
            |]</span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">{- | Multiplier PU model constructor. Argument defines the computation unit's
internal organization: using multiplier IP kernel (False) or mock (True). For
more information, look hardware function in 'TargetSystemComponent' class.
-}</span><span>
</span><span id="line-407"></span><span id="multiplier"><span class="annot"><span class="annottext">multiplier :: Bool -&gt; Multiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#multiplier"><span class="hs-identifier hs-var hs-var">multiplier</span></a></span></span><span> </span><span id="local-6989586621680367144"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680367144"><span class="hs-identifier hs-var">mock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:remain:Multiplier :: [F v x]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aremain%3AMultiplier"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:sources:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:currentWork:Multiplier :: Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var">currentWork</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:process_:Multiplier :: Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aprocess_%3AMultiplier"><span class="hs-identifier hs-var">process_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:isMocked:Multiplier :: Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AisMocked%3AMultiplier"><span class="hs-identifier hs-var">isMocked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680367144"><span class="hs-identifier hs-var">mock</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Default initial state of multiplier PU model.</span><span>
</span><span id="line-418"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367620"><span id="local-6989586621680367621"><span id="local-6989586621680367622"><span class="annot"><a href="NITTA.Model.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367622"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367621"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367620"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367622"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621680367136"><span class="annot"><span class="annottext">def :: Multiplier v x t
</span><a href="#local-6989586621680367136"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t} {v} {x}. Default t =&gt; Bool -&gt; Multiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#multiplier"><span class="hs-identifier hs-var">multiplier</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367132"><span id="local-6989586621680367615"><span id="local-6989586621680367616"><span id="local-6989586621680367617"><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="#local-6989586621680367617"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#DefaultX"><span class="hs-identifier hs-type">DefaultX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367616"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367617"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367615"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367617"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">{- | This class is allowed to extract all bound functions. It has a very simple
implementation: we take process description (all planned functions), and
function in progress, if it is.
-}</span><span>
</span><span id="line-427"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367606"><span id="local-6989586621680367607"><span id="local-6989586621680367608"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680367608"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#WithFunctions"><span class="hs-identifier hs-type">WithFunctions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367607"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367606"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367608"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367607"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367606"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621680367124"><span class="annot"><span class="annottext">functions :: Multiplier v x t -&gt; [F v x]
</span><a href="NITTA.Intermediate.Types.html#functions"><span class="hs-identifier hs-var hs-var hs-var hs-var">functions</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680367122"><span class="annot"><span class="annottext">Process t (StepInfo v x t)
process_ :: Process t (StepInfo v x t)
$sel:process_:Multiplier :: forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="#local-6989586621680367122"><span class="hs-identifier hs-var hs-var">process_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367121"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680367121"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367120"><span class="annot"><span class="annottext">Maybe (F v x)
currentWork :: Maybe (F v x)
$sel:currentWork:Multiplier :: forall v x t. Multiplier v x t -&gt; Maybe (F v x)
</span><a href="#local-6989586621680367120"><span class="hs-identifier hs-var hs-var">currentWork</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">forall a f. WithFunctions a f =&gt; a -&gt; [f]
</span><a href="NITTA.Intermediate.Types.html#functions"><span class="hs-identifier hs-var">functions</span></a></span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680367122"><span class="hs-identifier hs-var">process_</span></a></span><span>
</span><span id="line-430"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680367121"><span class="hs-identifier hs-var">remain</span></a></span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe (F v x)
</span><a href="#local-6989586621680367120"><span class="hs-identifier hs-var">currentWork</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">{- | Tracking internal dependencies on the processed variables. It includes:

- dependencies between inputs and outputs of currently evaluated function;

- dependencies of all remain functions from the currently evaluated function
  (if it is).
-}</span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367591"><span id="local-6989586621680367592"><span id="local-6989586621680367593"><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367593"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367593"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367592"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367591"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367593"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621680367105"><span class="annot"><span class="annottext">locks :: Multiplier v x t -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#locks"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680367103"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680367103"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367102"><span class="annot"><span class="annottext">[v]
sources :: [v]
$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680367102"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367101"><span class="annot"><span class="annottext">[v]
targets :: [v]
$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680367101"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Lock"><span class="hs-identifier hs-type">Lock</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">v
lockBy :: v
lockBy :: v
</span><a href="#local-6989586621680367098"><span class="hs-identifier hs-var hs-var">lockBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
locked :: v
locked :: v
</span><a href="#local-6989586621680367096"><span class="hs-identifier hs-var hs-var">locked</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-443"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680367097"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367097"><span class="hs-identifier hs-var">locked</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680367102"><span class="hs-identifier hs-var">sources</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367099"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367099"><span class="hs-identifier hs-var">lockBy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680367101"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Lock"><span class="hs-identifier hs-type">Lock</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">v
lockBy :: v
lockBy :: v
</span><a href="#local-6989586621680367095"><span class="hs-identifier hs-var hs-var">lockBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
locked :: v
locked :: v
</span><a href="#local-6989586621680367094"><span class="hs-identifier hs-var hs-var">locked</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-447"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680367094"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367094"><span class="hs-identifier hs-var">locked</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.elems</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680367103"><span class="hs-identifier hs-var">remain</span></a></span><span>
</span><span id="line-448"></span><span>               </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367095"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367095"><span class="hs-identifier hs-var">lockBy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680367102"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680367101"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-449"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall x v. Locks x v =&gt; x -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#locks"><span class="hs-identifier hs-var">locks</span></a></span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680367103"><span class="hs-identifier hs-var">remain</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">{- | That type classes ('BreakLoopProblem', 'OptimizeAccumProblem',
'ResolveDeadlockProblem', 'ConstantFoldingProblem') describes the possibility of PU to modify an
algorithm. Empty implementation means that multiplier PU doesn't have such
possibilities.
-}</span><span>
</span><span id="line-457"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367086"><span id="local-6989586621680367088"><span id="local-6989586621680367569"><span id="local-6989586621680367570"><span id="local-6989586621680367571"><span class="annot"><a href="NITTA.Model.Problems.Refactor.BreakLoop.html#BreakLoopProblem"><span class="hs-identifier hs-type">BreakLoopProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367571"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367570"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367569"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367571"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367570"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367081"><span id="local-6989586621680367083"><span id="local-6989586621680367562"><span id="local-6989586621680367563"><span id="local-6989586621680367564"><span class="annot"><a href="NITTA.Model.Problems.Refactor.ConstantFolding.html#ConstantFoldingProblem"><span class="hs-identifier hs-type">ConstantFoldingProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367564"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367563"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367562"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367564"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367563"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-460"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367076"><span id="local-6989586621680367078"><span id="local-6989586621680367555"><span id="local-6989586621680367556"><span id="local-6989586621680367557"><span class="annot"><a href="NITTA.Model.Problems.Refactor.OptimizeAccum.html#OptimizeAccumProblem"><span class="hs-identifier hs-type">OptimizeAccumProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367557"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367556"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367555"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367557"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367556"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-461"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367071"><span id="local-6989586621680367073"><span id="local-6989586621680367548"><span id="local-6989586621680367549"><span id="local-6989586621680367550"><span class="annot"><a href="NITTA.Model.Problems.Refactor.OptimizeLogicalUnit.html#OptimizeLogicalUnitProblem"><span class="hs-identifier hs-type">OptimizeLogicalUnitProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367550"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367549"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367548"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367550"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367549"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367066"><span id="local-6989586621680367068"><span id="local-6989586621680367541"><span id="local-6989586621680367542"><span id="local-6989586621680367543"><span class="annot"><a href="NITTA.Model.Problems.Refactor.ResolveDeadlock.html#ResolveDeadlockProblem"><span class="hs-identifier hs-type">ResolveDeadlockProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367543"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367542"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367541"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367543"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367542"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">{- | This type class specifies how to bind functions to the PU. If it is
possible, @tryBind@ function will return @Right@ value with a new PU model
state. If not, @Left@ value with reason description. And also specify how to
get computation process description.

From the CAD point of view, bind looks like:

- CAD asks PU models: &quot;Who can evaluate this function?&quot; and get the list of
  possible bindings.

- CAD, based on the different metrics (see 'NITTA.Synthesis'), the best variant
  is chosen.

Binding can be done either gradually due synthesis process at the start.
-}</span><span>
</span><span id="line-479"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367057"><span id="local-6989586621680367059"><span id="local-6989586621680367532"><span id="local-6989586621680367533"><span id="local-6989586621680367534"><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367534"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367533"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367532"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessorUnit"><span class="hs-identifier hs-type">ProcessorUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367534"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367533"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367532"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367534"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367533"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367532"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621680367048"><span class="annot"><span class="annottext">tryBind :: F v x -&gt; Multiplier v x t -&gt; Either String (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#tryBind"><span class="hs-identifier hs-var hs-var hs-var hs-var">tryBind</span></a></span></span><span> </span><span id="local-6989586621680367046"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367046"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680367045"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680367045"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680367044"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680367044"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">F.Multiply</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) v x.
(Typeable f, Typeable v, Typeable x) =&gt;
F v x -&gt; Maybe (f v x)
</span><a href="NITTA.Intermediate.Types.html#castF"><span class="hs-identifier hs-var">castF</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367046"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680367045"><span class="hs-identifier hs-var">pu</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:remain:Multiplier :: [F v x]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aremain%3AMultiplier"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367046"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680367044"><span class="hs-identifier hs-var">remain</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-482"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The function is unsupported by Multiplier: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367046"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-comment">-- Unified interface for getting computation process description.</span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621680367040"><span class="annot"><span class="annottext">process :: Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#process"><span class="hs-identifier hs-var hs-var hs-var hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aprocess_%3AMultiplier"><span class="hs-identifier hs-var">process_</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | Execute function (set as current and remove from remain).</span><span>
</span><span id="line-488"></span><span id="execution"><span class="annot"><span class="annottext">execution :: Multiplier v x t -&gt; F v x -&gt; Multiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#execution"><span class="hs-identifier hs-var hs-var">execution</span></a></span></span><span> </span><span id="local-6989586621680367028"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680367028"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680367027"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680367027"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680367026"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367026"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">F.Multiply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680367024"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367024"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680367023"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367023"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680367021"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680367021"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) v x.
(Typeable f, Typeable v, Typeable x) =&gt;
F v x -&gt; Maybe (f v x)
</span><a href="NITTA.Intermediate.Types.html#castF"><span class="hs-identifier hs-var">castF</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367026"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680367028"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367024"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680367023"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:currentWork:Multiplier :: Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var">currentWork</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367026"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-493"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:sources:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680367021"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:remain:Multiplier :: [F v x]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aremain%3AMultiplier"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680367027"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680367026"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-496"></span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#execution"><span class="hs-identifier hs-var">execution</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">F v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplier: internal execution error.&quot;</span></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">{- | A computational process of PU from a hardware architectural perspective can
be described as a sequence of pushing and pulling values. From a synthesis
perspective, it is represented by 'EndpointProblem', which describes when PU
is a 'Source' or 'Target' of data transfers.

Work with endpoint problem implemented by only two functions:

__endpointOptions__ define what the possible synthesis decision is. It
includes three cases:

- Not a function is executed. That means that we have options to push any
  input variables of remain functions.

- The function is executed, and not all arguments are received. We have
  options to push remain variables.

- The function is executed, and all arguments are received. We have options
  to pull the result from the multiplier, which can include several
  variables. These variables can be got one by one or all at once because the
  value will be written to the bus and read by several processor units on the
  hardware level.

Note: an option don't specify moment for action but specify an available
interval ('NITTA.Model.Types.TimeConstraint'). That describes the interval for
action start and restriction on process duration.

__endpointDecision__ defines how to apply synthesis decision to the PU model.
It includes three cases:

- Push an input variable of the executed function. We need to schedule
  instruction for endpoint action and modify the model state.

- Pull an output variable or variables of the executed function. We need to
  schedule instruction for endpoint action and modify the model state.

- Push an input variable of a not executed function. In this case, we need to
  find the selected function, 'execute' it, and do a recursive call with the
  same decision.
-}</span><span>
</span><span id="line-537"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367500"><span id="local-6989586621680367501"><span id="local-6989586621680367502"><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367502"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367501"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367500"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#EndpointProblem"><span class="hs-identifier hs-type">EndpointProblem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367502"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367501"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367500"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367502"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367500"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621680366975"><span class="annot"><span class="annottext">endpointOptions :: Multiplier v x t -&gt; [EndpointSt v (TimeConstraint t)]
</span><a href="NITTA.Model.Problems.Endpoint.html#endpointOptions"><span class="hs-identifier hs-var hs-var hs-var hs-var">endpointOptions</span></a></span></span><span> </span><span id="local-6989586621680366973"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680366973"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366972"><span class="annot"><span class="annottext">[v]
targets :: [v]
$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680366972"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-539"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366972"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-540"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366969"><span class="annot"><span class="annottext">at :: Interval t
</span><a href="#local-6989586621680366969"><span class="hs-identifier hs-var hs-var">at</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u t. NextTick u t =&gt; u -&gt; t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick"><span class="hs-identifier hs-var">nextTick</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366973"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Interval a
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-541"></span><span>                </span><span id="local-6989586621680366963"><span class="annot"><span class="annottext">duration :: Interval t
</span><a href="#local-6989586621680366963"><span class="hs-identifier hs-var hs-var">duration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Interval a
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-542"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680366962"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680366962"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall v tp. EndpointRole v -&gt; tp -&gt; EndpointSt v tp
</span><a href="NITTA.Model.Problems.Endpoint.html#EndpointSt"><span class="hs-identifier hs-var">EndpointSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. v -&gt; EndpointRole v
</span><a href="NITTA.Model.Problems.Endpoint.html#Target"><span class="hs-identifier hs-var">Target</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680366962"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. Interval t -&gt; Interval t -&gt; TimeConstraint t
</span><a href="NITTA.Model.Time.html#TimeConstraint"><span class="hs-identifier hs-var">TimeConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366969"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366963"><span class="hs-identifier hs-var">duration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366972"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#endpointOptions"><span class="hs-identifier hs-var">endpointOptions</span></a></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366958"><span class="annot"><span class="annottext">[v]
sources :: [v]
$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680366958"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:currentWork:Multiplier :: forall v x t. Multiplier v x t -&gt; Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var">currentWork</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680366957"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366957"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366956"><span class="annot"><span class="annottext">Process t (StepInfo v x t)
process_ :: Process t (StepInfo v x t)
$sel:process_:Multiplier :: forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="#local-6989586621680366956"><span class="hs-identifier hs-var hs-var">process_</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-544"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366958"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-545"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366955"><span class="annot"><span class="annottext">doneAt :: t
</span><a href="#local-6989586621680366955"><span class="hs-identifier hs-var hs-var">doneAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a1} {a2} {f} {x} {t2}.
(Ord a1, Ord a2, Function f a2) =&gt;
Process a1 (StepInfo a2 x t2) -&gt; f -&gt; a1
</span><a href="NITTA.Utils.html#inputsPushedAt"><span class="hs-identifier hs-var">inputsPushedAt</span></a></span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680366956"><span class="hs-identifier hs-var">process_</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366957"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">3</span></span><span>
</span><span id="line-546"></span><span>                </span><span id="local-6989586621680366952"><span class="annot"><span class="annottext">at :: Interval t
</span><a href="#local-6989586621680366952"><span class="hs-identifier hs-var hs-var">at</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680366955"><span class="hs-identifier hs-var">doneAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall u t. NextTick u t =&gt; u -&gt; t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick"><span class="hs-identifier hs-var">nextTick</span></a></span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680366956"><span class="hs-identifier hs-var">process_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Interval a
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-547"></span><span>                </span><span id="local-6989586621680366947"><span class="annot"><span class="annottext">duration :: Interval t
</span><a href="#local-6989586621680366947"><span class="hs-identifier hs-var hs-var">duration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Interval a
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-548"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall v tp. EndpointRole v -&gt; tp -&gt; EndpointSt v tp
</span><a href="NITTA.Model.Problems.Endpoint.html#EndpointSt"><span class="hs-identifier hs-var">EndpointSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Set v -&gt; EndpointRole v
</span><a href="NITTA.Model.Problems.Endpoint.html#Source"><span class="hs-identifier hs-var">Source</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366958"><span class="hs-identifier hs-var">sources</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. Interval t -&gt; Interval t -&gt; TimeConstraint t
</span><a href="NITTA.Model.Time.html#TimeConstraint"><span class="hs-identifier hs-var">TimeConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366952"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366947"><span class="hs-identifier hs-var">duration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#endpointOptions"><span class="hs-identifier hs-var">endpointOptions</span></a></span><span> </span><span id="local-6989586621680366944"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680366944"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366943"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680366943"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall u v t.
EndpointProblem u v t =&gt;
u -&gt; [EndpointSt v (TimeConstraint t)]
</span><a href="NITTA.Model.Problems.Endpoint.html#endpointOptions"><span class="hs-identifier hs-var">endpointOptions</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {v} {x} {t}.
(Typeable v, Typeable x) =&gt;
Multiplier v x t -&gt; F v x -&gt; Multiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#execution"><span class="hs-identifier hs-var">execution</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366944"><span class="hs-identifier hs-var">pu</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680366943"><span class="hs-identifier hs-var">remain</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621680366866"><span class="annot"><span class="annottext">endpointDecision :: Multiplier v x t -&gt; EndpointSt v (Interval t) -&gt; Multiplier v x t
</span><a href="NITTA.Model.Problems.Endpoint.html#endpointDecision"><span class="hs-identifier hs-var hs-var hs-var hs-var">endpointDecision</span></a></span></span><span> </span><span id="local-6989586621680366864"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680366864"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366863"><span class="annot"><span class="annottext">[v]
targets :: [v]
$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680366863"><span class="hs-identifier hs-var hs-var">targets</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680366862"><span class="annot"><span class="annottext">d :: EndpointSt v (Interval t)
</span><a href="#local-6989586621680366862"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#EndpointSt"><span class="hs-identifier hs-type">EndpointSt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">epRole :: forall v tp. EndpointSt v tp -&gt; EndpointRole v
</span><a href="NITTA.Model.Problems.Endpoint.html#epRole"><span class="hs-identifier hs-var">epRole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span> </span><span id="local-6989586621680366860"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680366860"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366859"><span class="annot"><span class="annottext">Interval t
epAt :: forall v tp. EndpointSt v tp -&gt; tp
epAt :: Interval t
</span><a href="NITTA.Model.Problems.Endpoint.html#epAt"><span class="hs-identifier hs-var hs-var">epAt</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-552"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366863"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366857"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366857"><span class="hs-identifier hs-var">targets'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680366860"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366863"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-554"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">--  Computation process planning is carried out.</span><span>
</span><span id="line-555"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366856"><span class="annot"><span class="annottext">process_' :: Process t (StepInfo v x t)
</span><a href="#local-6989586621680366856"><span class="hs-identifier hs-var hs-var">process_'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {u} {v} {x} {t} {a}.
ProcessorUnit u v x t =&gt;
u -&gt; State (Schedule u v x t) a -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Utils.ProcessDescription.html#execSchedule"><span class="hs-identifier hs-var">execSchedule</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366864"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>                </span><span class="hs-comment">-- this is required for correct work of automatically generated tests,</span><span>
</span><span id="line-557"></span><span>                </span><span class="hs-comment">-- that takes information about time from Process</span><span>
</span><span id="line-558"></span><span>                </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {pu} {v} {x} {t}.
MonadState (Schedule pu v x t) m =&gt;
EndpointSt v (Interval t) -&gt; m [Int] -&gt; m [Int]
</span><a href="NITTA.Utils.ProcessDescription.html#scheduleEndpoint"><span class="hs-identifier hs-var">scheduleEndpoint</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366862"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {pu} {v} {x} {t} {m :: * -&gt; *}.
(MonadState (Schedule pu v x t) m, Show (Instruction pu),
 Typeable pu, Num t) =&gt;
Interval t -&gt; Instruction pu -&gt; m [Int]
</span><a href="NITTA.Utils.ProcessDescription.html#scheduleInstructionUnsafe"><span class="hs-identifier hs-var">scheduleInstructionUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366859"><span class="hs-identifier hs-var">epAt</span></a></span><span> </span><span class="annot"><span class="annottext">forall v x t. Instruction (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Load"><span class="hs-identifier hs-var">Load</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>            </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366864"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-560"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:process_:Multiplier :: Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aprocess_%3AMultiplier"><span class="hs-identifier hs-var">process_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680366856"><span class="hs-identifier hs-var">process_'</span></a></span><span>
</span><span id="line-561"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- The remainder of the work is saved for the next loop</span><span>
</span><span id="line-562"></span><span>                  </span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366857"><span class="hs-identifier hs-var">targets'</span></a></span><span>
</span><span id="line-563"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-564"></span><span>    </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#endpointDecision"><span class="hs-identifier hs-var">endpointDecision</span></a></span><span> </span><span id="local-6989586621680366851"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680366851"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366850"><span class="annot"><span class="annottext">[v]
sources :: [v]
$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="#local-6989586621680366850"><span class="hs-identifier hs-var hs-var">sources</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:currentWork:Multiplier :: forall v x t. Multiplier v x t -&gt; Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var">currentWork</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680366849"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366849"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366848"><span class="annot"><span class="annottext">Process t (StepInfo v x t)
process_ :: Process t (StepInfo v x t)
$sel:process_:Multiplier :: forall v x t. Multiplier v x t -&gt; Process t (StepInfo v x t)
</span><a href="#local-6989586621680366848"><span class="hs-identifier hs-var hs-var">process_</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680366847"><span class="annot"><span class="annottext">d :: EndpointSt v (Interval t)
</span><a href="#local-6989586621680366847"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#EndpointSt"><span class="hs-identifier hs-type">EndpointSt</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">epRole :: forall v tp. EndpointSt v tp -&gt; EndpointRole v
</span><a href="NITTA.Model.Problems.Endpoint.html#epRole"><span class="hs-identifier hs-var">epRole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#Source"><span class="hs-identifier hs-type">Source</span></a></span><span> </span><span id="local-6989586621680366846"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680366846"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366845"><span class="annot"><span class="annottext">Interval t
epAt :: Interval t
epAt :: forall v tp. EndpointSt v tp -&gt; tp
</span><a href="#local-6989586621680366845"><span class="hs-identifier hs-var hs-var">epAt</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366850"><span class="hs-identifier hs-var">sources</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366844"><span class="annot"><span class="annottext">sources' :: [v]
</span><a href="#local-6989586621680366844"><span class="hs-identifier hs-var hs-var">sources'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366850"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680366846"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366844"><span class="hs-identifier hs-var">sources'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366850"><span class="hs-identifier hs-var">sources</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366842"><span class="annot"><span class="annottext">a :: t
</span><a href="#local-6989586621680366842"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Interval a -&gt; a
</span><span class="hs-identifier hs-var">inf</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {i}. Ord a =&gt; [Step a i] -&gt; Interval a
</span><a href="NITTA.Utils.html#stepsInterval"><span class="hs-identifier hs-var">stepsInterval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {t1} {x} {t2}.
Ord a =&gt;
Process t1 (StepInfo a x t2)
-&gt; Set a -&gt; [Step t1 (StepInfo a x t2)]
</span><a href="NITTA.Utils.ProcessDescription.html#relatedEndpoints"><span class="hs-identifier hs-var">relatedEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680366848"><span class="hs-identifier hs-var">process_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366849"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Compututation process planning is carring on.</span><span>
</span><span id="line-570"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366839"><span class="annot"><span class="annottext">process_' :: Process t (StepInfo v x t)
</span><a href="#local-6989586621680366839"><span class="hs-identifier hs-var hs-var">process_'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {u} {v} {x} {t} {a}.
ProcessorUnit u v x t =&gt;
u -&gt; State (Schedule u v x t) a -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Utils.ProcessDescription.html#execSchedule"><span class="hs-identifier hs-var">execSchedule</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366851"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>                </span><span id="local-6989586621680366838"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680366838"><span class="hs-identifier hs-var">endpoints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {pu} {v} {x} {t}.
MonadState (Schedule pu v x t) m =&gt;
EndpointSt v (Interval t) -&gt; m [Int] -&gt; m [Int]
</span><a href="NITTA.Utils.ProcessDescription.html#scheduleEndpoint"><span class="hs-identifier hs-var">scheduleEndpoint</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366847"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {pu} {v} {x} {t} {m :: * -&gt; *}.
(MonadState (Schedule pu v x t) m, Show (Instruction pu),
 Typeable pu, Num t) =&gt;
Interval t -&gt; Instruction pu -&gt; m [Int]
</span><a href="NITTA.Utils.ProcessDescription.html#scheduleInstructionUnsafe"><span class="hs-identifier hs-var">scheduleInstructionUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366845"><span class="hs-identifier hs-var">epAt</span></a></span><span> </span><span class="annot"><span class="annottext">forall v x t. Instruction (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Out"><span class="hs-identifier hs-var">Out</span></a></span><span>
</span><span id="line-572"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366844"><span class="hs-identifier hs-var">sources'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>                    </span><span class="hs-comment">-- Set up the vertical relantions between functional unit</span><span>
</span><span id="line-574"></span><span>                    </span><span class="hs-comment">-- and related to that data sending.</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>                    </span><span class="hs-comment">-- FIXME: here ([]) you can see the source of error.</span><span>
</span><span id="line-577"></span><span>                    </span><span class="hs-comment">-- Function don't connected to bind step. It should be fixed.</span><span>
</span><span id="line-578"></span><span>                    </span><span class="annot"><span class="annottext">forall {v} {x} {t} {pu}.
(Ord v, Typeable v, IsString v, ToString v, Suffix v,
 Hashable v) =&gt;
[Int]
-&gt; F v x -&gt; Interval t -&gt; StateT (Schedule pu v x t) Identity ()
</span><a href="NITTA.Utils.ProcessDescription.html#scheduleFunctionFinish_"><span class="hs-identifier hs-var">scheduleFunctionFinish_</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366849"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680366842"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Interval a
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">forall a. Interval a -&gt; a
</span><span class="hs-identifier hs-var">sup</span></span><span> </span><span class="annot"><span class="annottext">Interval t
</span><a href="#local-6989586621680366845"><span class="hs-identifier hs-var">epAt</span></a></span><span>
</span><span id="line-579"></span><span>                </span><span class="hs-comment">-- this is needed to correct work of automatically generated tests</span><span>
</span><span id="line-580"></span><span>                </span><span class="hs-comment">-- that takes time about time from Process</span><span>
</span><span id="line-581"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680366838"><span class="hs-identifier hs-var">endpoints</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-582"></span><span>            </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366851"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-583"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:process_:Multiplier :: Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aprocess_%3AMultiplier"><span class="hs-identifier hs-var">process_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t)
</span><a href="#local-6989586621680366839"><span class="hs-identifier hs-var">process_'</span></a></span><span>
</span><span id="line-584"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- In case if not all variables what asked - remaining are saved.</span><span>
</span><span id="line-585"></span><span>                  </span><span class="annot"><span class="annottext">$sel:sources:Multiplier :: [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366844"><span class="hs-identifier hs-var">sources'</span></a></span><span>
</span><span id="line-586"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- if all of works is done, then time when result is ready,</span><span>
</span><span id="line-587"></span><span>                  </span><span class="hs-comment">-- current work and data transfering, what is done is the current function is reset.</span><span>
</span><span id="line-588"></span><span>                  </span><span class="annot"><span class="annottext">$sel:currentWork:Multiplier :: Maybe (F v x)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AcurrentWork%3AMultiplier"><span class="hs-identifier hs-var">currentWork</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680366844"><span class="hs-identifier hs-var">sources'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366849"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-589"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#endpointDecision"><span class="hs-identifier hs-var">endpointDecision</span></a></span><span> </span><span id="local-6989586621680366835"><span class="annot"><span class="annottext">pu :: Multiplier v x t
</span><a href="#local-6989586621680366835"><span class="hs-identifier hs-var">pu</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:targets:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Atargets%3AMultiplier"><span class="hs-identifier hs-var">targets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:sources:Multiplier :: forall v x t. Multiplier v x t -&gt; [v]
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Asources%3AMultiplier"><span class="hs-identifier hs-var">sources</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366834"><span class="annot"><span class="annottext">[F v x]
remain :: [F v x]
$sel:remain:Multiplier :: forall v x t. Multiplier v x t -&gt; [F v x]
</span><a href="#local-6989586621680366834"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680366833"><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366833"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-591"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680366832"><span class="annot"><span class="annottext">v :: v
</span><a href="#local-6989586621680366832"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {c}. Set c -&gt; c
</span><a href="NITTA.Utils.Base.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366833"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680366830"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366830"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680366829"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366829"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680366832"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366829"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[F v x]
</span><a href="#local-6989586621680366834"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-593"></span><span>            </span><span class="annot"><span class="annottext">forall u v t.
EndpointProblem u v t =&gt;
u -&gt; EndpointSt v (Interval t) -&gt; u
</span><a href="NITTA.Model.Problems.Endpoint.html#endpointDecision"><span class="hs-identifier hs-var">endpointDecision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {v} {x} {t}.
(Typeable v, Typeable x) =&gt;
Multiplier v x t -&gt; F v x -&gt; Multiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#execution"><span class="hs-identifier hs-var">execution</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366835"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680366830"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366833"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="hs-comment">-- If something went wrong.</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#endpointDecision"><span class="hs-identifier hs-var">endpointDecision</span></a></span><span> </span><span id="local-6989586621680366827"><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366827"><span class="hs-identifier hs-var">pu</span></a></span></span><span> </span><span id="local-6989586621680366826"><span class="annot"><span class="annottext">EndpointSt v (Interval t)
</span><a href="#local-6989586621680366826"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="">[i|incorrect decision #{ d } for #{ pretty pu }|]</span></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">{- | For each PU, we can specify the instruction set and microcode, which allows
us to control the PU at the hardware level.

- instructions set describes a computation process from a programmer point of
  view;

- microcode describes the structure of processors that controls signals.

The implementation had the internal register, which allows us to simply push the
data in the unit, without any specification of argument position. It will be
always a sequence of the first and second arguments.
-}</span><span>
</span><span id="line-609"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367401"><span id="local-6989586621680367402"><span id="local-6989586621680367403"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Controllable"><span class="hs-identifier hs-type">Controllable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367402"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367401"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Instruction"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a></span></span><span> </span><span id="local-6989586621680367401"><span id="local-6989586621680367402"><span id="local-6989586621680367403"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367402"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367401"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span id="Load"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Load"><span class="hs-identifier hs-var">Load</span></a></span></span><span>
</span><span id="line-612"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="Out"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Out"><span class="hs-identifier hs-var">Out</span></a></span></span><span>
</span><span id="line-613"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366815"><span id="local-6989586621680366817"><span id="local-6989586621680366819"><span class="annot"><span class="annottext">Int -&gt; Instruction (Multiplier v x t) -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v x t. Int -&gt; Instruction (Multiplier v x t) -&gt; ShowS
forall v x t. [Instruction (Multiplier v x t)] -&gt; ShowS
forall v x t. Instruction (Multiplier v x t) -&gt; String
showList :: [Instruction (Multiplier v x t)] -&gt; ShowS
$cshowList :: forall v x t. [Instruction (Multiplier v x t)] -&gt; ShowS
show :: Instruction (Multiplier v x t) -&gt; String
$cshow :: forall v x t. Instruction (Multiplier v x t) -&gt; String
showsPrec :: Int -&gt; Instruction (Multiplier v x t) -&gt; ShowS
$cshowsPrec :: forall v x t. Int -&gt; Instruction (Multiplier v x t) -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Microcode"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-var">Microcode</span></a></span></span><span> </span><span id="local-6989586621680367401"><span id="local-6989586621680367402"><span id="local-6989586621680367403"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367402"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367401"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Microcode"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Microcode"><span class="hs-identifier hs-var">Microcode</span></a></span></span><span>
</span><span id="line-616"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- \| Write to mUnit signal.</span><span>
</span><span id="line-617"></span><span>          </span><span id="%24sel%3AwrSignal%3AMicrocode"><span class="annot"><span class="annottext">forall v x t. Microcode (Multiplier v x t) -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AwrSignal%3AMicrocode"><span class="hs-identifier hs-var hs-var">wrSignal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-618"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- \| Downloading from mUnit signal.</span><span>
</span><span id="line-619"></span><span>          </span><span id="%24sel%3AoeSignal%3AMicrocode"><span class="annot"><span class="annottext">forall v x t. Microcode (Multiplier v x t) -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AoeSignal%3AMicrocode"><span class="hs-identifier hs-var hs-var">oeSignal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-620"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366801"><span id="local-6989586621680366803"><span id="local-6989586621680366809"><span class="annot"><span class="annottext">Int -&gt; Microcode (Multiplier v x t) -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v x t. Int -&gt; Microcode (Multiplier v x t) -&gt; ShowS
forall v x t. [Microcode (Multiplier v x t)] -&gt; ShowS
forall v x t. Microcode (Multiplier v x t) -&gt; String
showList :: [Microcode (Multiplier v x t)] -&gt; ShowS
$cshowList :: forall v x t. [Microcode (Multiplier v x t)] -&gt; ShowS
show :: Microcode (Multiplier v x t) -&gt; String
$cshow :: forall v x t. Microcode (Multiplier v x t) -&gt; String
showsPrec :: Int -&gt; Microcode (Multiplier v x t) -&gt; ShowS
$cshowsPrec :: forall v x t. Int -&gt; Microcode (Multiplier v x t) -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366794"><span id="local-6989586621680366799"><span class="annot"><span class="annottext">Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
/= :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c/= :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
== :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c== :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366769"><span id="local-6989586621680366771"><span id="local-6989586621680366774"><span id="local-6989586621680366777"><span id="local-6989586621680366780"><span id="local-6989586621680366784"><span id="local-6989586621680366789"><span class="annot"><span class="annottext">Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall v x t. Eq (Microcode (Multiplier v x t))
forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Ordering
forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
min :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
$cmin :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
max :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
$cmax :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
&gt;= :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c&gt;= :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
&gt; :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c&gt; :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
&lt;= :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c&lt;= :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
&lt; :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
$c&lt; :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Bool
compare :: Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Ordering
$ccompare :: forall v x t.
Microcode (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621680366767"><span class="annot"><span class="annottext">zipSignalTagsAndValues :: Ports (Multiplier v x t)
-&gt; Microcode (Multiplier v x t) -&gt; [(SignalTag, SignalValue)]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#zipSignalTagsAndValues"><span class="hs-identifier hs-var hs-var hs-var hs-var">zipSignalTagsAndValues</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-type">MultiplierPorts</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366763"><span id="local-6989586621680366764"><span class="annot"><span class="annottext">SignalTag
$sel:oe:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
$sel:wr:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
oe :: SignalTag
wr :: SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aoe%3AMultiplierPorts"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366759"><span id="local-6989586621680366760"><span class="annot"><span class="annottext">Bool
oeSignal :: Bool
wrSignal :: Bool
$sel:oeSignal:Microcode :: forall v x t. Microcode (Multiplier v x t) -&gt; Bool
$sel:wrSignal:Microcode :: forall v x t. Microcode (Multiplier v x t) -&gt; Bool
</span><a href="#local-6989586621680366759"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-624"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366764"><span class="hs-identifier hs-var">wr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680366760"><span class="hs-identifier hs-var">wrSignal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366763"><span class="hs-identifier hs-var">oe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680366759"><span class="hs-identifier hs-var">oeSignal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621680366757"><span class="annot"><span class="annottext">usedPortTags :: Ports (Multiplier v x t) -&gt; [SignalTag]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#usedPortTags"><span class="hs-identifier hs-var hs-var hs-var hs-var">usedPortTags</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-type">MultiplierPorts</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366755"><span class="annot"><span class="annottext">SignalTag
wr :: SignalTag
$sel:wr:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
</span><a href="#local-6989586621680366755"><span class="hs-identifier hs-var hs-var">wr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366754"><span class="annot"><span class="annottext">SignalTag
oe :: SignalTag
$sel:oe:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
</span><a href="#local-6989586621680366754"><span class="hs-identifier hs-var hs-var">oe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366755"><span class="hs-identifier hs-var">wr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366754"><span class="hs-identifier hs-var">oe</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621680366751"><span class="annot"><span class="annottext">takePortTags :: [SignalTag] -&gt; Multiplier v x t -&gt; Ports (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#takePortTags"><span class="hs-identifier hs-var hs-var hs-var hs-var">takePortTags</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366749"><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366749"><span class="hs-identifier hs-var">wr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680366748"><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366748"><span class="hs-identifier hs-var">oe</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[SignalTag]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v x t. SignalTag -&gt; SignalTag -&gt; Ports (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-var">MultiplierPorts</span></a></span><span> </span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366749"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="annot"><span class="annottext">SignalTag
</span><a href="#local-6989586621680366748"><span class="hs-identifier hs-var">oe</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#takePortTags"><span class="hs-identifier hs-var">takePortTags</span></a></span><span> </span><span class="annot"><span class="annottext">[SignalTag]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;can not take port tags, tags are over&quot;</span></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">{- | Default microcode state should be equal to @nop@ function, which should be a
safe way to do nothing (not take a bus, not change internal PU state, etc.).
-}</span><span>
</span><span id="line-636"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367383"><span id="local-6989586621680367384"><span id="local-6989586621680367385"><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367385"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367384"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367383"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-637"></span><span>    </span><span id="local-6989586621680366745"><span class="annot"><span class="annottext">def :: Microcode (Multiplier v x t)
</span><a href="#local-6989586621680366745"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-638"></span><span>        </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span>
</span><span id="line-639"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:wrSignal:Microcode :: Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AwrSignal%3AMicrocode"><span class="hs-identifier hs-var">wrSignal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-640"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:oeSignal:Microcode :: Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AoeSignal%3AMicrocode"><span class="hs-identifier hs-var">oeSignal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-641"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">{- | Instruction and microcode should have exact matching, which allows us to
translate PU instructions to microcode value.
-}</span><span>
</span><span id="line-646"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367375"><span id="local-6989586621680367376"><span id="local-6989586621680367377"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnambiguouslyDecode"><span class="hs-identifier hs-type">UnambiguouslyDecode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367377"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367376"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367375"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621680366739"><span class="annot"><span class="annottext">decodeInstruction :: Instruction (Multiplier v x t) -&gt; Microcode (Multiplier v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#decodeInstruction"><span class="hs-identifier hs-var hs-var hs-var hs-var">decodeInstruction</span></a></span></span><span> </span><span class="annot"><span class="annottext">Instruction (Multiplier v x t)
R:InstructionMultiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Load"><span class="hs-identifier hs-var">Load</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:wrSignal:Microcode :: Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AwrSignal%3AMicrocode"><span class="hs-identifier hs-var">wrSignal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#decodeInstruction"><span class="hs-identifier hs-var">decodeInstruction</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction (Multiplier v x t)
R:InstructionMultiplier v x t
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Out"><span class="hs-identifier hs-var">Out</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:oeSignal:Microcode :: Bool
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3AoeSignal%3AMicrocode"><span class="hs-identifier hs-var">oeSignal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="hs-comment">{- | Processor unit control signal ports. In
'NITTA.Model.Networks.Bus.BusNetwork', these ports are directly connecting to
@ControlUnit@.
-}</span><span>
</span><span id="line-654"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367369"><span id="local-6989586621680367370"><span id="local-6989586621680367371"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Connected"><span class="hs-identifier hs-type">Connected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367371"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367370"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367369"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Ports"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier hs-var">Ports</span></a></span></span><span> </span><span id="local-6989586621680367369"><span id="local-6989586621680367370"><span id="local-6989586621680367371"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367371"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367370"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367369"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MultiplierPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-var">MultiplierPorts</span></a></span></span><span>
</span><span id="line-656"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- \|get data from the bus (data_in)</span><span>
</span><span id="line-657"></span><span>          </span><span id="%24sel%3Awr%3AMultiplierPorts"><span class="annot"><span class="annottext">forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Awr%3AMultiplierPorts"><span class="hs-identifier hs-var hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- \|send result to the bus</span><span>
</span><span id="line-659"></span><span>          </span><span id="%24sel%3Aoe%3AMultiplierPorts"><span class="annot"><span class="annottext">forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aoe%3AMultiplierPorts"><span class="hs-identifier hs-var hs-var">oe</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span><span>
</span><span id="line-660"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-661"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366726"><span id="local-6989586621680366728"><span id="local-6989586621680366734"><span class="annot"><span class="annottext">Int -&gt; Ports (Multiplier v x t) -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v x t. Int -&gt; Ports (Multiplier v x t) -&gt; ShowS
forall v x t. [Ports (Multiplier v x t)] -&gt; ShowS
forall v x t. Ports (Multiplier v x t) -&gt; String
showList :: [Ports (Multiplier v x t)] -&gt; ShowS
$cshowList :: forall v x t. [Ports (Multiplier v x t)] -&gt; ShowS
show :: Ports (Multiplier v x t) -&gt; String
$cshow :: forall v x t. Ports (Multiplier v x t) -&gt; String
showsPrec :: Int -&gt; Ports (Multiplier v x t) -&gt; ShowS
$cshowsPrec :: forall v x t. Int -&gt; Ports (Multiplier v x t) -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680366720"><span id="local-6989586621680366722"><span id="local-6989586621680366724"><span id="local-6989586621680367356"><span id="local-6989586621680367357"><span id="local-6989586621680367358"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOConnected"><span class="hs-identifier hs-type">IOConnected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367358"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367357"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367356"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="IOPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier hs-var">IOPorts</span></a></span></span><span> </span><span id="local-6989586621680367356"><span id="local-6989586621680367357"><span id="local-6989586621680367358"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367358"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367357"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367356"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MultiplierIO"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierIO"><span class="hs-identifier hs-var">MultiplierIO</span></a></span></span><span>
</span><span id="line-665"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366712"><span id="local-6989586621680366714"><span id="local-6989586621680366716"><span class="annot"><span class="annottext">Int -&gt; IOPorts (Multiplier v x t) -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v x t. Int -&gt; IOPorts (Multiplier v x t) -&gt; ShowS
forall v x t. [IOPorts (Multiplier v x t)] -&gt; ShowS
forall v x t. IOPorts (Multiplier v x t) -&gt; String
showList :: [IOPorts (Multiplier v x t)] -&gt; ShowS
$cshowList :: forall v x t. [IOPorts (Multiplier v x t)] -&gt; ShowS
show :: IOPorts (Multiplier v x t) -&gt; String
$cshow :: forall v x t. IOPorts (Multiplier v x t) -&gt; String
showsPrec :: Int -&gt; IOPorts (Multiplier v x t) -&gt; ShowS
$cshowsPrec :: forall v x t. Int -&gt; IOPorts (Multiplier v x t) -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">{- | Usage of PU requires some artifacts of a synthesis process:

- Hardware implementation, which depends from 'isMocked' value:

- Software (not needed for the multiplier because it does not have any
  configuration and is controlled from the network level).

- Hardware instance in the upper structure element.
-}</span><span>
</span><span id="line-676"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367341"><span id="local-6989586621680367342"><span id="local-6989586621680367343"><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367343"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367342"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367341"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Project.Types.html#TargetSystemComponent"><span class="hs-identifier hs-type">TargetSystemComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367343"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367342"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367341"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-677"></span><span>    </span><span id="local-6989586621680366697"><span class="annot"><span class="annottext">moduleName :: Text -&gt; Multiplier v x t -&gt; Text
</span><a href="NITTA.Project.Types.html#moduleName"><span class="hs-identifier hs-var hs-var hs-var hs-var">moduleName</span></a></span></span><span> </span><span id="local-6989586621680366695"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366695"><span class="hs-identifier hs-var">_title</span></a></span></span><span> </span><span id="local-6989586621680366694"><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366694"><span class="hs-identifier hs-var">_pu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;pu_multiplier&quot;</span></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621680366693"><span class="annot"><span class="annottext">hardware :: Text -&gt; Multiplier v x t -&gt; Implementation
</span><a href="NITTA.Project.Types.html#hardware"><span class="hs-identifier hs-var hs-var hs-var hs-var">hardware</span></a></span></span><span> </span><span id="local-6989586621680366691"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366691"><span class="hs-identifier hs-var">_tag</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366690"><span class="annot"><span class="annottext">Bool
isMocked :: Bool
$sel:isMocked:Multiplier :: forall v x t. Multiplier v x t -&gt; Bool
</span><a href="#local-6989586621680366690"><span class="hs-identifier hs-var hs-var">isMocked</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><span class="annottext">Maybe String -&gt; [Implementation] -&gt; Implementation
</span><a href="NITTA.Project.Types.html#Aggregate"><span class="hs-identifier hs-var">Aggregate</span></a></span><span>
</span><span id="line-681"></span><span>            </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-682"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680366690"><span class="hs-identifier hs-var">isMocked</span></a></span><span>
</span><span id="line-683"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Implementation
</span><a href="NITTA.Project.Types.html#FromLibrary"><span class="hs-identifier hs-var">FromLibrary</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multiplier/mult_mock.v&quot;</span></span><span>
</span><span id="line-684"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Implementation
</span><a href="NITTA.Project.Types.html#FromLibrary"><span class="hs-identifier hs-var">FromLibrary</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multiplier/mult_inner.v&quot;</span></span><span>
</span><span id="line-685"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Implementation
</span><a href="NITTA.Project.Types.html#FromLibrary"><span class="hs-identifier hs-var">FromLibrary</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multiplier/pu_multiplier.v&quot;</span></span><span>
</span><span id="line-686"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621680366687"><span class="annot"><span class="annottext">software :: Text -&gt; Multiplier v x t -&gt; Implementation
</span><a href="NITTA.Project.Types.html#software"><span class="hs-identifier hs-var hs-var hs-var hs-var">software</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Implementation
</span><a href="NITTA.Project.Types.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621680366611"><span class="annot"><span class="annottext">hardwareInstance :: Text -&gt; Multiplier v x t -&gt; UnitEnv (Multiplier v x t) -&gt; Verilog
</span><a href="NITTA.Project.Types.html#hardwareInstance"><span class="hs-identifier hs-var hs-var hs-var hs-var">hardwareInstance</span></a></span></span><span>
</span><span id="line-691"></span><span>        </span><span id="local-6989586621680366609"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366609"><span class="hs-identifier hs-var">tag</span></a></span></span><span>
</span><span id="line-692"></span><span>        </span><span id="local-6989586621680366608"><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366608"><span class="hs-identifier hs-var">_pu</span></a></span></span><span>
</span><span id="line-693"></span><span>        </span><span class="annot"><a href="NITTA.Project.Types.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span>
</span><span id="line-694"></span><span>            </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680366606"><span class="annot"><span class="annottext">Text
sigClk :: forall m. UnitEnv m -&gt; Text
sigClk :: Text
</span><a href="NITTA.Project.Types.html#sigClk"><span class="hs-identifier hs-var hs-var">sigClk</span></a></span></span><span>
</span><span id="line-695"></span><span>            </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366604"><span class="annot"><span class="annottext">Text
sigRst :: forall m. UnitEnv m -&gt; Text
sigRst :: Text
</span><a href="NITTA.Project.Types.html#sigRst"><span class="hs-identifier hs-var hs-var">sigRst</span></a></span></span><span>
</span><span id="line-696"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctrlPorts :: forall m. UnitEnv m -&gt; Maybe (Ports m)
</span><a href="NITTA.Project.Types.html#ctrlPorts"><span class="hs-identifier hs-var">ctrlPorts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-type">MultiplierPorts</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366600"><span id="local-6989586621680366601"><span class="annot"><span class="annottext">SignalTag
oe :: SignalTag
wr :: SignalTag
$sel:oe:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
$sel:wr:MultiplierPorts :: forall v x t. Ports (Multiplier v x t) -&gt; SignalTag
</span><a href="#local-6989586621680366600"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-697"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">valueIn :: forall m. UnitEnv m -&gt; Maybe (Text, Text)
</span><a href="NITTA.Project.Types.html#valueIn"><span class="hs-identifier hs-var">valueIn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366598"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366598"><span class="hs-identifier hs-var">dataIn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366597"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366597"><span class="hs-identifier hs-var">attrIn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">valueOut :: forall m. UnitEnv m -&gt; Maybe (Text, Text)
</span><a href="NITTA.Project.Types.html#valueOut"><span class="hs-identifier hs-var">valueOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680366595"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366595"><span class="hs-identifier hs-var">dataOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366594"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366594"><span class="hs-identifier hs-var">attrOut</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>            </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>            </span><span class="annot"><span class="">[__i|
                pu_multiplier \#
                        ( .DATA_WIDTH( #{ dataWidth (def :: x) } )
                        , .ATTR_WIDTH( #{ attrWidth (def :: x) } )
                        , .SCALING_FACTOR_POWER( #{ fractionalBitSize (def :: x) } )
                        , .INVALID( 0 )
                        ) #{ tag }
                    ( .clk( #{ sigClk } )
                    , .rst( #{ sigRst } )
                    , .signal_wr( #{ wr } )
                    , .data_in( #{ dataIn } )
                    , .attr_in( #{ attrIn } )
                    , .signal_oe( #{ oe } )
                    , .data_out( #{ dataOut } )
                    , .attr_out( #{ attrOut } )
                    );
            |]</span></span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><a href="NITTA.Project.Types.html#hardwareInstance"><span class="hs-identifier hs-var">hardwareInstance</span></a></span><span> </span><span id="local-6989586621680366590"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366590"><span class="hs-identifier hs-var">_title</span></a></span></span><span> </span><span id="local-6989586621680366589"><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366589"><span class="hs-identifier hs-var">_pu</span></a></span></span><span> </span><span id="local-6989586621680366588"><span class="annot"><span class="annottext">UnitEnv (Multiplier v x t)
</span><a href="#local-6989586621680366588"><span class="hs-identifier hs-var">_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;internal error&quot;</span></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">{- | Empty implementation of 'NITTA.Project.TestBench.IOTestBench' class
means that multiplier, as expected, doesn't have any IO.
-}</span><span>
</span><span id="line-722"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680366584"><span id="local-6989586621680366586"><span id="local-6989586621680367328"><span id="local-6989586621680367329"><span id="local-6989586621680367330"><span class="annot"><a href="NITTA.Project.TestBench.html#IOTestBench"><span class="hs-identifier hs-type">IOTestBench</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367330"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367329"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367328"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367330"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367329"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-comment">{- | The main purpose of this class is to generate autotests for PU. It allows to
generate testbench for the PU according to its model and scheduled computational
process. You can see tests in @test/Spec.hs@. Testbench contains:

- The sequence of control signals that implement the already scheduled process.

- The sequence of bus state checks in which we compare actual values with the
  results of the functional simulation.
-}</span><span>
</span><span id="line-733"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680367317"><span id="local-6989586621680367318"><span id="local-6989586621680367319"><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367319"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367318"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367317"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Project.TestBench.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Multiplier"><span class="hs-identifier hs-type">Multiplier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367319"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367318"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367317"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680367319"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680367318"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621680366532"><span class="annot"><span class="annottext">testBenchImplementation :: Project (Multiplier v x t) v x -&gt; Implementation
</span><a href="NITTA.Project.TestBench.html#testBenchImplementation"><span class="hs-identifier hs-var hs-var hs-var hs-var">testBenchImplementation</span></a></span></span><span> </span><span id="local-6989586621680366530"><span class="annot"><span class="annottext">prj :: Project (Multiplier v x t) v x
</span><a href="#local-6989586621680366530"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366528"><span class="annot"><span class="annottext">Text
pName :: forall m v x. Project m v x -&gt; Text
pName :: Text
</span><a href="NITTA.Project.Types.html#pName"><span class="hs-identifier hs-var hs-var">pName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366526"><span class="annot"><span class="annottext">Multiplier v x t
pUnit :: forall m v x. Project m v x -&gt; m
pUnit :: Multiplier v x t
</span><a href="NITTA.Project.Types.html#pUnit"><span class="hs-identifier hs-var hs-var">pUnit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; Implementation
</span><a href="NITTA.Project.Types.html#Immediate"><span class="hs-identifier hs-var">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall pu. TargetSystemComponent pu =&gt; Text -&gt; pu -&gt; Text
</span><a href="NITTA.Project.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680366528"><span class="hs-identifier hs-var">pName</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplier v x t
</span><a href="#local-6989586621680366526"><span class="hs-identifier hs-var">pUnit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_tb.v&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-736"></span><span>            </span><span class="annot"><span class="annottext">forall m v x t.
(WithFunctions m (F v x), ProcessorUnit m v x t,
 TargetSystemComponent m, UnambiguouslyDecode m, Typeable m,
 Show (Instruction m), Default (Microcode m)) =&gt;
Project m v x -&gt; SnippetTestBenchConf m -&gt; Text
</span><a href="NITTA.Project.TestBench.html#snippetTestBench"><span class="hs-identifier hs-var">snippetTestBench</span></a></span><span>
</span><span id="line-737"></span><span>                </span><span class="annot"><span class="annottext">Project (Multiplier v x t) v x
</span><a href="#local-6989586621680366530"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-738"></span><span>                </span><span class="annot"><a href="NITTA.Project.TestBench.html#SnippetTestBenchConf"><span class="hs-identifier hs-type">SnippetTestBenchConf</span></a></span><span>
</span><span id="line-739"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- List of control signals. It is needed to initialize</span><span>
</span><span id="line-740"></span><span>                      </span><span class="hs-comment">-- registers with the same names.</span><span>
</span><span id="line-741"></span><span>                      </span><span class="annot"><span class="annottext">tbcSignals :: [Text]
</span><a href="#local-6989586621680366521"><span class="hs-identifier hs-var">tbcSignals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;oe&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wr&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-742"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- A processor unit connects to the environment by signal</span><span>
</span><span id="line-743"></span><span>                      </span><span class="hs-comment">-- lines. In 'NITTA.Project.TestBench.tbcPorts'</span><span>
</span><span id="line-744"></span><span>                      </span><span class="hs-comment">-- describes IDs signal lines of testbench. In</span><span>
</span><span id="line-745"></span><span>                      </span><span class="hs-comment">-- 'NITTA.Project.TestBench.tbcSignalConnect' how</span><span>
</span><span id="line-746"></span><span>                      </span><span class="hs-comment">-- abstract numbers are translate to source code.</span><span>
</span><span id="line-747"></span><span>                      </span><span class="annot"><span class="annottext">tbcPorts :: Ports (Multiplier v x t)
</span><a href="#local-6989586621680366520"><span class="hs-identifier hs-var">tbcPorts</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-748"></span><span>                        </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#MultiplierPorts"><span class="hs-identifier hs-type">MultiplierPorts</span></a></span><span>
</span><span id="line-749"></span><span>                            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:oe:MultiplierPorts :: SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Aoe%3AMultiplierPorts"><span class="hs-identifier hs-var">oe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-var">SignalTag</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;oe&quot;</span></span><span>
</span><span id="line-750"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:wr:MultiplierPorts :: SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Multiplier.html#%24sel%3Awr%3AMultiplierPorts"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SignalTag
</span><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-var">SignalTag</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wr&quot;</span></span><span>
</span><span id="line-751"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-752"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Map microcode to registers in the testbench.</span><span>
</span><span id="line-753"></span><span>                      </span><span class="annot"><span class="annottext">tbcMC2verilogLiteral :: Microcode (Multiplier v x t) -&gt; Text
</span><a href="#local-6989586621680366518"><span class="hs-identifier hs-var">tbcMC2verilogLiteral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Multiplier.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span class="hs-special">{</span><span id="local-6989586621680366517"><span class="annot"><span class="annottext">Bool
oeSignal :: Bool
$sel:oeSignal:Microcode :: forall v x t. Microcode (Multiplier v x t) -&gt; Bool
</span><a href="#local-6989586621680366517"><span class="hs-identifier hs-var hs-var">oeSignal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680366516"><span class="annot"><span class="annottext">Bool
wrSignal :: Bool
$sel:wrSignal:Microcode :: forall v x t. Microcode (Multiplier v x t) -&gt; Bool
</span><a href="#local-6989586621680366516"><span class="hs-identifier hs-var hs-var">wrSignal</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-754"></span><span>                        </span><span class="annot"><span class="">[i|oe &lt;= #{bool2verilog oeSignal};|]</span></span><span>
</span><span id="line-755"></span><span>                            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="">[i| wr &lt;= #{bool2verilog wrSignal};|]</span></span><span>
</span><span id="line-756"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-757"></span></pre></body></html>