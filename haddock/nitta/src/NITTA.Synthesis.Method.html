<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">{- |
Module      : NITTA.Synthesis.Method
Description : Synthesis method implementation.
Copyright   : (c) Aleksandr Penskoi, 2021
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental
-}</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Synthesis.Method</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier">DefTree</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier">SynthesisMethod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#noSynthesis"><span class="hs-identifier">noSynthesis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#simpleSynthesisIO"><span class="hs-identifier">simpleSynthesisIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#smartBindSynthesisIO"><span class="hs-identifier">smartBindSynthesisIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#obviousBindThreadIO"><span class="hs-identifier">obviousBindThreadIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO"><span class="hs-identifier">topDownByScoreSynthesisIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier">allBestThreadIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#stateOfTheArtSynthesisIO"><span class="hs-identifier">stateOfTheArtSynthesisIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#allBindsAndRefsIO"><span class="hs-identifier">allBindsAndRefsIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Method.html#bestStepIO"><span class="hs-identifier">bestStepIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier">SynthesisMethodConstraints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Heap</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Networks.Bus.html"><span class="hs-identifier">NITTA.Model.Networks.Bus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Networks.Bus.html#BusNetwork"><span class="hs-identifier">BusNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.html"><span class="hs-identifier">NITTA.Model.ProcessorUnits</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.TargetSystem.html"><span class="hs-identifier">NITTA.Model.TargetSystem</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Explore.html"><span class="hs-identifier">NITTA.Synthesis.Explore</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Steps.html"><span class="hs-identifier">NITTA.Synthesis.Steps</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html"><span class="hs-identifier">NITTA.Synthesis.Types</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html"><span class="hs-identifier">NITTA.UIBackend.Types</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.html"><span class="hs-identifier">NITTA.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Utils.Base.html#maximumOn"><span class="hs-identifier">maximumOn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Utils.Base.html#minimumOn"><span class="hs-identifier">minimumOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Safe</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Log.Logger</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">{- | The constant, which restricts the maximum number of synthesis steps. Avoids
the endless synthesis process.
-}</span><span>
</span><span id="line-49"></span><span id="stepLimit"><span class="annot"><span class="annottext">stepLimit :: Int
</span><a href="NITTA.Synthesis.Method.html#stepLimit"><span class="hs-identifier hs-var hs-var">stepLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">750</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621680319067"><span id="local-6989586621680319068"><span id="local-6989586621680319069"><span id="local-6989586621680319070"><span class="annot"><a href="NITTA.Synthesis.Method.html#noSynthesis"><span class="hs-identifier hs-type">noSynthesis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319070"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319069"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319068"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319067"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319070"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319069"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319068"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319067"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-52"></span><span id="noSynthesis"><span class="annot"><span class="annottext">noSynthesis :: forall tag v x t. BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#noSynthesis"><span class="hs-identifier hs-var hs-var">noSynthesis</span></a></span></span><span> </span><span id="local-6989586621680318754"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318754"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span id="local-6989586621680318753"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318753"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;noSynthesis&quot;</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318753"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | The most complex synthesis method, which embedded all another. That all.</span><span>
</span><span id="line-57"></span><span id="local-6989586621680319054"><span id="local-6989586621680319055"><span id="local-6989586621680319056"><span id="local-6989586621680319057"><span class="annot"><a href="NITTA.Synthesis.Method.html#stateOfTheArtSynthesisIO"><span class="hs-identifier hs-type">stateOfTheArtSynthesisIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319057"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319055"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319054"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319057"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319055"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319054"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319057"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319055"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319054"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-58"></span><span id="stateOfTheArtSynthesisIO"><span class="annot"><span class="annottext">stateOfTheArtSynthesisIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#stateOfTheArtSynthesisIO"><span class="hs-identifier hs-var hs-var">stateOfTheArtSynthesisIO</span></a></span></span><span> </span><span id="local-6989586621680318728"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318727"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stateOfTheArtSynthesisIO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621680318724"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318724"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#simpleSynthesisIO"><span class="hs-identifier hs-var">simpleSynthesisIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621680318723"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318723"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#smartBindSynthesisIO"><span class="hs-identifier hs-var">smartBindSynthesisIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621680318722"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318722"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="NITTA.Synthesis.Method.html#stepLimit"><span class="hs-identifier hs-var">stepLimit</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621680318720"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318720"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="NITTA.Synthesis.Method.html#stepLimit"><span class="hs-identifier hs-var">stepLimit</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBindsAndRefsIO"><span class="hs-identifier hs-var">allBindsAndRefsIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621680318718"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318718"><span class="hs-identifier hs-var">l5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousGroupBindsIO"><span class="hs-identifier hs-var">obviousGroupBindsIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
SynthesisMethod tag v x t
-&gt; BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#tryAllGroupBindsByIO"><span class="hs-identifier hs-var">tryAllGroupBindsByIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="NITTA.Synthesis.Method.html#stepLimit"><span class="hs-identifier hs-var">stepLimit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318728"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
DefTree tag v x t -&gt; [DefTree tag v x t] -&gt; DefTree tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestLeaf"><span class="hs-identifier hs-var">bestLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318727"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318724"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318723"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318722"><span class="hs-identifier hs-var">l3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318720"><span class="hs-identifier hs-var">l4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318718"><span class="hs-identifier hs-var">l5</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Schedule process by simple synthesis.</span><span>
</span><span id="line-68"></span><span id="local-6989586621680318711"><span id="local-6989586621680318712"><span id="local-6989586621680318713"><span id="local-6989586621680318714"><span class="annot"><a href="NITTA.Synthesis.Method.html#simpleSynthesisIO"><span class="hs-identifier hs-type">simpleSynthesisIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318714"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318713"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318712"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318711"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318714"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318713"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318712"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318711"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318714"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318713"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318712"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318711"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-69"></span><span id="simpleSynthesisIO"><span class="annot"><span class="annottext">simpleSynthesisIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#simpleSynthesisIO"><span class="hs-identifier hs-var hs-var">simpleSynthesisIO</span></a></span></span><span> </span><span id="local-6989586621680318703"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318703"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318702"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318702"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simpleSynthesisIO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318702"><span class="hs-identifier hs-var">root</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621680318701"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318701"><span class="hs-identifier hs-var">lastObviousNode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousBindThreadIO"><span class="hs-identifier hs-var">obviousBindThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318703"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318702"><span class="hs-identifier hs-var">root</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-var">allBestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318703"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318701"><span class="hs-identifier hs-var">lastObviousNode</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621680318697"><span id="local-6989586621680318698"><span id="local-6989586621680318699"><span id="local-6989586621680318700"><span class="annot"><a href="NITTA.Synthesis.Method.html#smartBindSynthesisIO"><span class="hs-identifier hs-type">smartBindSynthesisIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318700"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318699"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318698"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318697"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318700"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318699"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318698"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318697"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318700"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318699"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318698"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318697"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-75"></span><span id="smartBindSynthesisIO"><span class="annot"><span class="annottext">smartBindSynthesisIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#smartBindSynthesisIO"><span class="hs-identifier hs-var hs-var">smartBindSynthesisIO</span></a></span></span><span> </span><span id="local-6989586621680318689"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318689"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318688"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318688"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;smartBindSynthesisIO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318688"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621680318687"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318687"><span class="hs-identifier hs-var">tree'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#smartBindThreadIO"><span class="hs-identifier hs-var">smartBindThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318689"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318688"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-var">allBestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318689"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318687"><span class="hs-identifier hs-var">tree'</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621680319032"><span id="local-6989586621680319033"><span id="local-6989586621680319034"><span id="local-6989586621680319035"><span class="annot"><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-type">bestThreadIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319035"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319034"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319033"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319032"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319035"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319034"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319033"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319032"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319035"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319034"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319033"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319032"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-81"></span><span id="bestThreadIO"><span class="annot"><span class="annottext">bestThreadIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var hs-var">bestThreadIO</span></a></span></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680318632"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318632"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bestThreadIO've reached the step limit!&quot;</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318632"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span id="local-6989586621680318631"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318631"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318630"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680318630"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621680318629"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318629"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621680318628"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318628"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318631"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318629"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318628"><span class="hs-identifier hs-var">subForest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318629"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318631"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680318630"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#maximumOn"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318628"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621680318620"><span id="local-6989586621680318621"><span id="local-6989586621680318622"><span id="local-6989586621680318623"><span class="annot"><a href="NITTA.Synthesis.Method.html#bestStepIO"><span class="hs-identifier hs-type">bestStepIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318623"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318622"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318621"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318620"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318623"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318622"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318621"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318620"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318623"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318622"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318621"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318620"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-89"></span><span id="bestStepIO"><span class="annot"><span class="annottext">bestStepIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestStepIO"><span class="hs-identifier hs-var hs-var">bestStepIO</span></a></span></span><span> </span><span id="local-6989586621680318574"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318574"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318573"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318573"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621680318572"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318572"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318574"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318573"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318572"><span class="hs-identifier hs-var">subForest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;all step is over&quot;</span></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#maximumOn"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318572"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621680318567"><span id="local-6989586621680318568"><span id="local-6989586621680318569"><span id="local-6989586621680318570"><span class="annot"><a href="NITTA.Synthesis.Method.html#obviousGroupBindsIO"><span class="hs-identifier hs-type">obviousGroupBindsIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318570"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318569"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318568"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318567"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318570"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318569"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318568"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318567"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318570"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318569"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318568"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318567"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-96"></span><span id="obviousGroupBindsIO"><span class="annot"><span class="annottext">obviousGroupBindsIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousGroupBindsIO"><span class="hs-identifier hs-var hs-var">obviousGroupBindsIO</span></a></span></span><span> </span><span id="local-6989586621680318559"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318559"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318558"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318558"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621680318557"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318557"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t m ctx.
(SynthesisMethodConstraints tag v x t,
 m ~ TargetSystem (BusNetwork tag v x t) tag v x t,
 ctx ~ SynthesisState m tag v x t) =&gt;
(SynthesisDecision ctx m -&gt; Bool)
-&gt; BackendCtx tag v x t
-&gt; DefTree tag v x t
-&gt; IO [DefTree tag v x t]
</span><a href="NITTA.Synthesis.Method.html#selectSubForestIO"><span class="hs-identifier hs-var">selectSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.Bind.html#isObviousMultiBind"><span class="hs-identifier hs-var">isObviousMultiBind</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318559"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318558"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318558"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousGroupBindsIO"><span class="hs-identifier hs-var">obviousGroupBindsIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318559"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t. [DefTree tag v x t] -&gt; Maybe (DefTree tag v x t)
</span><a href="NITTA.Synthesis.Method.html#bestDecision"><span class="hs-identifier hs-var">bestDecision</span></a></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318557"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621680319023"><span id="local-6989586621680319024"><span id="local-6989586621680319025"><span id="local-6989586621680319026"><span class="annot"><a href="NITTA.Synthesis.Method.html#tryAllGroupBindsByIO"><span class="hs-identifier hs-type">tryAllGroupBindsByIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319026"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319025"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319024"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319023"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319026"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319025"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319024"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319023"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319026"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319025"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319024"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319023"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319026"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319025"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319024"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319023"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-101"></span><span id="tryAllGroupBindsByIO"><span class="annot"><span class="annottext">tryAllGroupBindsByIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
SynthesisMethod tag v x t
-&gt; BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#tryAllGroupBindsByIO"><span class="hs-identifier hs-var hs-var">tryAllGroupBindsByIO</span></a></span></span><span> </span><span id="local-6989586621680318541"><span class="annot"><span class="annottext">SynthesisMethod tag v x t
</span><a href="#local-6989586621680318541"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621680318540"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318540"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318539"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318539"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621680318538"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318538"><span class="hs-identifier hs-var">bindSubForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tag v x t m ctx.
(SynthesisMethodConstraints tag v x t,
 m ~ TargetSystem (BusNetwork tag v x t) tag v x t,
 ctx ~ SynthesisState m tag v x t) =&gt;
(SynthesisDecision ctx m -&gt; Bool)
-&gt; BackendCtx tag v x t
-&gt; DefTree tag v x t
-&gt; IO [DefTree tag v x t]
</span><a href="NITTA.Synthesis.Method.html#selectSubForestIO"><span class="hs-identifier hs-var">selectSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.Bind.html#isMultiBind"><span class="hs-identifier hs-var">isMultiBind</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318540"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318539"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621680318536"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318536"><span class="hs-identifier hs-var">leafs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SynthesisMethod tag v x t
</span><a href="#local-6989586621680318541"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318538"><span class="hs-identifier hs-var">bindSubForest</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
DefTree tag v x t -&gt; [DefTree tag v x t] -&gt; DefTree tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestLeaf"><span class="hs-identifier hs-var">bestLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318539"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318536"><span class="hs-identifier hs-var">leafs</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span id="local-6989586621680318531"><span id="local-6989586621680318532"><span id="local-6989586621680318533"><span id="local-6989586621680318534"><span class="annot"><a href="NITTA.Synthesis.Method.html#obviousBindThreadIO"><span class="hs-identifier hs-type">obviousBindThreadIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318534"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318533"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318532"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318534"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318533"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318532"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318534"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318533"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318532"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318531"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-107"></span><span id="obviousBindThreadIO"><span class="annot"><span class="annottext">obviousBindThreadIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousBindThreadIO"><span class="hs-identifier hs-var hs-var">obviousBindThreadIO</span></a></span></span><span> </span><span id="local-6989586621680318457"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318457"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318456"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318456"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621680318455"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318455"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318457"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318456"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318456"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#obviousBindThreadIO"><span class="hs-identifier hs-var">obviousBindThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318457"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">L.find</span></span><span>
</span><span id="line-111"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-112"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Steps.Bind.html#SingleBindMetrics"><span class="hs-identifier hs-type">SingleBindMetrics</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">pPossibleDeadlock :: BindMetrics -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.Bind.html#pPossibleDeadlock"><span class="hs-identifier hs-var">pPossibleDeadlock</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-113"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Steps.Bind.html#SingleBindMetrics"><span class="hs-identifier hs-type">SingleBindMetrics</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">pAlternative :: BindMetrics -&gt; Float
</span><a href="NITTA.Synthesis.Steps.Bind.html#pAlternative"><span class="hs-identifier hs-var">pAlternative</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-114"></span><span>                    </span><span class="annot"><span class="annottext">Maybe BindMetrics
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-115"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span>
</span><span id="line-117"></span><span>                </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318455"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621680318446"><span id="local-6989586621680318447"><span id="local-6989586621680318448"><span id="local-6989586621680318449"><span class="annot"><a href="NITTA.Synthesis.Method.html#allBindsAndRefsIO"><span class="hs-identifier hs-type">allBindsAndRefsIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318449"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318448"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318447"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318446"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318449"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318448"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318447"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318446"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318449"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318448"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318447"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318446"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-122"></span><span id="allBindsAndRefsIO"><span class="annot"><span class="annottext">allBindsAndRefsIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBindsAndRefsIO"><span class="hs-identifier hs-var hs-var">allBindsAndRefsIO</span></a></span></span><span> </span><span id="local-6989586621680318399"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318399"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318398"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318398"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621680318397"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318397"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680318396"><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318396"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.Bind.html#isSingleBind"><span class="hs-identifier hs-var">isSingleBind</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318396"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.html#isRefactor"><span class="hs-identifier hs-var">isRefactor</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318396"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318399"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318398"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318397"><span class="hs-identifier hs-var">subForest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318398"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBindsAndRefsIO"><span class="hs-identifier hs-var">allBindsAndRefsIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318399"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#minimumOn"><span class="hs-identifier hs-var">minimumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318397"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621680318388"><span id="local-6989586621680318389"><span id="local-6989586621680318390"><span id="local-6989586621680318391"><span class="annot"><a href="NITTA.Synthesis.Method.html#refactorThreadIO"><span class="hs-identifier hs-type">refactorThreadIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318391"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318389"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318388"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318391"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318389"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318388"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318391"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318389"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318388"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-131"></span><span id="refactorThreadIO"><span class="annot"><span class="annottext">refactorThreadIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#refactorThreadIO"><span class="hs-identifier hs-var hs-var">refactorThreadIO</span></a></span></span><span> </span><span id="local-6989586621680318343"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318343"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318342"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318342"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621680318341"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318341"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318343"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318342"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318342"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#refactorThreadIO"><span class="hs-identifier hs-var">refactorThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318343"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">L.find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.html#isRefactor"><span class="hs-identifier hs-var">isRefactor</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318341"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span id="local-6989586621680318337"><span id="local-6989586621680318338"><span id="local-6989586621680318339"><span id="local-6989586621680318340"><span class="annot"><a href="NITTA.Synthesis.Method.html#smartBindThreadIO"><span class="hs-identifier hs-type">smartBindThreadIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318340"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318339"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318338"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318337"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318340"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318339"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318338"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318337"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318340"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318339"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318338"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318337"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-137"></span><span id="smartBindThreadIO"><span class="annot"><span class="annottext">smartBindThreadIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#smartBindThreadIO"><span class="hs-identifier hs-var hs-var">smartBindThreadIO</span></a></span></span><span> </span><span id="local-6989586621680318289"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318289"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318288"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318288"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621680318287"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318287"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680318286"><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318286"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.Bind.html#isSingleBind"><span class="hs-identifier hs-var">isSingleBind</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318286"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Bool
</span><a href="NITTA.Synthesis.Steps.html#isRefactor"><span class="hs-identifier hs-var">isRefactor</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680318286"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318289"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#refactorThreadIO"><span class="hs-identifier hs-var">refactorThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318289"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318288"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318287"><span class="hs-identifier hs-var">subForest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318288"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#smartBindThreadIO"><span class="hs-identifier hs-var">smartBindThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318289"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#maximumOn"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318287"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621680318282"><span id="local-6989586621680318283"><span id="local-6989586621680318284"><span id="local-6989586621680318285"><span class="annot"><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-type">allBestThreadIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318285"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318284"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318283"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318282"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318285"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318284"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318283"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318282"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318285"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318284"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318283"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318282"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-146"></span><span id="allBestThreadIO"><span class="annot"><span class="annottext">allBestThreadIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-var hs-var">allBestThreadIO</span></a></span></span><span> </span><span id="local-6989586621680318230"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318230"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680318229"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318229"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestThreadIO"><span class="hs-identifier hs-var">bestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318230"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="NITTA.Synthesis.Method.html#stepLimit"><span class="hs-identifier hs-var">stepLimit</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318229"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-var">allBestThreadIO</span></a></span><span> </span><span id="local-6989586621680318228"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318228"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318227"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680318227"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680318226"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318226"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621680318225"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318225"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318228"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318226"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621680318224"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318224"><span class="hs-identifier hs-var">leafs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
BackendCtx tag v x t -&gt; Int -&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#allBestThreadIO"><span class="hs-identifier hs-var">allBestThreadIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680318228"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680318227"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318225"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
DefTree tag v x t -&gt; [DefTree tag v x t] -&gt; DefTree tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestLeaf"><span class="hs-identifier hs-var">bestLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318226"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318224"><span class="hs-identifier hs-var">leafs</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621680319019"><span id="local-6989586621680319020"><span id="local-6989586621680319021"><span id="local-6989586621680319022"><span class="annot"><a href="NITTA.Synthesis.Method.html#bestLeaf"><span class="hs-identifier hs-type">bestLeaf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319022"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319020"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319022"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319020"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319022"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319020"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319019"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319022"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319020"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680319019"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-153"></span><span id="bestLeaf"><span class="annot"><span class="annottext">bestLeaf :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
DefTree tag v x t -&gt; [DefTree tag v x t] -&gt; DefTree tag v x t
</span><a href="NITTA.Synthesis.Method.html#bestLeaf"><span class="hs-identifier hs-var hs-var">bestLeaf</span></a></span></span><span> </span><span id="local-6989586621680318204"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318204"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span id="local-6989586621680318203"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318203"><span class="hs-identifier hs-var">leafs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680318202"><span class="annot"><span class="annottext">successLeafs :: [DefTree tag v x t]
</span><a href="#local-6989586621680318202"><span class="hs-identifier hs-var hs-var">successLeafs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680318201"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318201"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Types.html#isComplete"><span class="hs-identifier hs-var">isComplete</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318201"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Types.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318201"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318203"><span class="hs-identifier hs-var">leafs</span></a></span><span>
</span><span id="line-155"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318202"><span class="hs-identifier hs-var">successLeafs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">headDef</span></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680318204"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318203"><span class="hs-identifier hs-var">leafs</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>                </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#minimumOn"><span class="hs-identifier hs-var">minimumOn</span></a></span><span>
</span><span id="line-159"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sState :: forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680318193"><span class="annot"><span class="annottext">TargetSystem (BusNetwork tag v x t) tag v x t
sTarget :: forall m tag v x t. SynthesisState m tag v x t -&gt; m
sTarget :: TargetSystem (BusNetwork tag v x t) tag v x t
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var hs-var">sTarget</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {u} {tag} {v} {x} {t}.
(Num a, NextTick u a) =&gt;
TargetSystem u tag v x t -&gt; a
</span><a href="NITTA.Model.TargetSystem.html#processDuration"><span class="hs-identifier hs-var">processDuration</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork tag v x t) tag v x t
</span><a href="#local-6989586621680318193"><span class="hs-identifier hs-var">sTarget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall u v x t. ProcessorUnit u v x t =&gt; u -&gt; Float
</span><a href="NITTA.Model.ProcessorUnits.Types.html#puSize"><span class="hs-identifier hs-var">puSize</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork tag v x t) tag v x t
</span><a href="#local-6989586621680318193"><span class="hs-identifier hs-var">sTarget</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>                    </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680318202"><span class="hs-identifier hs-var">successLeafs</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621680318845"><span id="local-6989586621680318846"><span id="local-6989586621680318847"><span id="local-6989586621680318848"><span class="annot"><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO"><span class="hs-identifier hs-type">topDownByScoreSynthesisIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318848"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318847"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318846"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318845"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318848"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318847"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318846"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318845"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethod"><span class="hs-identifier hs-type">SynthesisMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318848"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318847"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318846"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318845"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-163"></span><span id="topDownByScoreSynthesisIO"><span class="annot"><span class="annottext">topDownByScoreSynthesisIO :: forall tag v x t.
SynthesisMethodConstraints tag v x t =&gt;
Float
-&gt; Int
-&gt; Maybe Text
-&gt; BackendCtx tag v x t
-&gt; SynthesisMethod tag v x t
</span><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO"><span class="hs-identifier hs-var hs-var">topDownByScoreSynthesisIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {tag} {v} {x} {t} {pol} {t} {tag2} {v2} {x2} {t2}.
(UnitTag tag, Hashable v, Suffix v, Val x, Bounded t, ToJSONKey v,
 HeapItem
   pol
   (Float,
    Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t),
 Show t, Default t, Integral t, Integral t, ToJSON v, ToJSON t,
 ToJSON tag, Typeable v, Typeable t, Ord v, ToString v,
 IsString v) =&gt;
HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
-&gt; t
-&gt; Float
-&gt; t
-&gt; Maybe Text
-&gt; BackendCtx tag2 v2 x2 t2
-&gt; Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO%27"><span class="hs-identifier hs-var">topDownByScoreSynthesisIO'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680318140"><span id="local-6989586621680318141"><span id="local-6989586621680318142"><span id="local-6989586621680318143"><span class="annot"><span class="annottext">forall prio val. HeapT prio val
</span><span class="hs-identifier hs-var">H.empty</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MaxPrioHeap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318143"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318142"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318141"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318140"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="topDownByScoreSynthesisIO%27"><span class="annot"><span class="annottext">topDownByScoreSynthesisIO' :: HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
-&gt; t
-&gt; Float
-&gt; t
-&gt; Maybe Text
-&gt; BackendCtx tag2 v2 x2 t2
-&gt; Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO%27"><span class="hs-identifier hs-var hs-var">topDownByScoreSynthesisIO'</span></a></span></span><span> </span><span id="local-6989586621680318030"><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318030"><span class="hs-identifier hs-var">heap</span></a></span></span><span> </span><span id="local-6989586621680318029"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318029"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621680318028"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680318028"><span class="hs-identifier hs-var">depthCoeffBase</span></a></span></span><span> </span><span id="local-6989586621680318027"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318027"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621680318026"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680318026"><span class="hs-identifier hs-var">scoreKey</span></a></span></span><span> </span><span id="local-6989586621680318025"><span class="annot"><span class="annottext">BackendCtx tag2 v2 x2 t2
</span><a href="#local-6989586621680318025"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680318024"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318029"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318027"><span class="hs-identifier hs-var">limit</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topDownByScoreSynthesisIO - STEP LIMIT REACHED: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>            </span><span class="hs-comment">-- currentNode should not be in the heap at this point, but all its children will be</span><span>
</span><span id="line-172"></span><span>            </span><span id="local-6989586621680318022"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680318022"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag2 v2 x2 t2
</span><a href="#local-6989586621680318025"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680318020"><span class="annot"><span class="annottext">getNodeDepth :: Tree m tag v x t -&gt; Int
</span><a href="#local-6989586621680318020"><span class="hs-identifier hs-var hs-var">getNodeDepth</span></a></span></span><span> </span><span id="local-6989586621680318019"><span class="annot"><span class="annottext">Tree m tag v x t
</span><a href="#local-6989586621680318019"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span id="local-6989586621680318017"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680318017"><span class="hs-identifier hs-var">sidParts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680318017"><span class="hs-identifier hs-var">sidParts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree m tag v x t
</span><a href="#local-6989586621680318019"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-comment">-- priority calculation should prefer nodes that are closer to the leafs</span><span>
</span><span id="line-175"></span><span>                </span><span id="local-6989586621680318015"><span class="annot"><span class="annottext">depthCoeff :: Float
</span><a href="#local-6989586621680318015"><span class="hs-identifier hs-var hs-var">depthCoeff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680318028"><span class="hs-identifier hs-var">depthCoeffBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {m} {tag} {v} {x} {t}. Tree m tag v x t -&gt; Int
</span><a href="#local-6989586621680318020"><span class="hs-identifier hs-var">getNodeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>                </span><span id="local-6989586621680318013"><span class="annot"><span class="annottext">getScore :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318013"><span class="hs-identifier hs-var hs-var">getScore</span></a></span></span><span> </span><span id="local-6989586621680318012"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318012"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680318026"><span class="hs-identifier hs-var">scoreKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318012"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-178"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680318011"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680318011"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Map Text Float
</span><a href="NITTA.Synthesis.Types.html#scores"><span class="hs-identifier hs-var">scores</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318012"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">M.!</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680318011"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span id="local-6989586621680318008"><span class="annot"><span class="annottext">getPriority :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318008"><span class="hs-identifier hs-var hs-var">getPriority</span></a></span></span><span> </span><span id="local-6989586621680318007"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318007"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680318015"><span class="hs-identifier hs-var">depthCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318013"><span class="hs-identifier hs-var">getScore</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318007"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-180"></span><span>                </span><span class="hs-comment">-- heapWithSubforest = foldl (\acc child -&gt; H.insert (getPriority child, child) acc) heap subForest</span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-comment">-- the version above (fold + insert) takes 1.7x more time than below (fromList + union)</span><span>
</span><span id="line-182"></span><span>                </span><span id="local-6989586621680318005"><span class="annot"><span class="annottext">subForestOnlyHeap :: HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318005"><span class="hs-identifier hs-var hs-var">subForestOnlyHeap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall pol item. HeapItem pol item =&gt; [item] -&gt; Heap pol item
</span><span class="hs-identifier hs-var">H.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318008"><span class="hs-identifier hs-var">getPriority</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318003"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318003"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680318003"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318003"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680318022"><span class="hs-identifier hs-var">subForest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>                </span><span id="local-6989586621680318002"><span class="annot"><span class="annottext">heapWithSubforest :: HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318002"><span class="hs-identifier hs-var hs-var">heapWithSubforest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prio val.
Ord prio =&gt;
HeapT prio val -&gt; HeapT prio val -&gt; HeapT prio val
</span><span class="hs-identifier hs-var">H.union</span></span><span> </span><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318030"><span class="hs-identifier hs-var">heap</span></a></span><span> </span><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318005"><span class="hs-identifier hs-var">subForestOnlyHeap</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall pol item. HeapItem pol item =&gt; Heap pol item -&gt; Maybe item
</span><span class="hs-identifier hs-var">H.viewHead</span></span><span> </span><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318002"><span class="hs-identifier hs-var">heapWithSubforest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>                </span><span class="annot"><span class="annottext">Maybe
  (Float,
   Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topDownByScoreSynthesisIO - TREE EXHAUSTED: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span>
</span><span id="line-189"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680317999"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Types.html#isComplete"><span class="hs-identifier hs-var">isComplete</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-191"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>                            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topDownByScoreSynthesisIO - DONE: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-194"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680317998"><span class="annot"><span class="annottext">prio :: Float
</span><a href="#local-6989586621680317998"><span class="hs-identifier hs-var hs-var">prio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318008"><span class="hs-identifier hs-var">getPriority</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-196"></span><span>                                </span><span id="local-6989586621680317997"><span class="annot"><span class="annottext">depth :: Int
</span><a href="#local-6989586621680317997"><span class="hs-identifier hs-var hs-var">depth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m} {tag} {v} {x} {t}. Tree m tag v x t -&gt; Int
</span><a href="#local-6989586621680318020"><span class="hs-identifier hs-var">getNodeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-197"></span><span>                                </span><span id="local-6989586621680317996"><span class="annot"><span class="annottext">score :: Float
</span><a href="#local-6989586621680317996"><span class="hs-identifier hs-var hs-var">score</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Float
</span><a href="#local-6989586621680318013"><span class="hs-identifier hs-var">getScore</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-198"></span><span>                                </span><span class="hs-comment">-- the more steps we make, the more aggressively we drop nodes to find new ones</span><span>
</span><span id="line-199"></span><span>                                </span><span id="local-6989586621680317995"><span class="annot"><span class="annottext">aggressiveness :: Float
</span><a href="#local-6989586621680317995"><span class="hs-identifier hs-var hs-var">aggressiveness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.5</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-comment">-- [0.0; +inf)</span><span>
</span><span id="line-200"></span><span>                                </span><span id="local-6989586621680317993"><span class="annot"><span class="annottext">maxDrops :: Float
</span><a href="#local-6989586621680317993"><span class="hs-identifier hs-var hs-var">maxDrops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">5</span></span><span>
</span><span id="line-201"></span><span>                                </span><span id="local-6989586621680317991"><span class="annot"><span class="annottext">aggressiveDropPerSteps :: Float
</span><a href="#local-6989586621680317991"><span class="hs-identifier hs-var hs-var">aggressiveDropPerSteps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2500.0</span></span><span>
</span><span id="line-202"></span><span>                                </span><span id="local-6989586621680317990"><span class="annot"><span class="annottext">aggressiveDropCount :: Float
</span><a href="#local-6989586621680317990"><span class="hs-identifier hs-var hs-var">aggressiveDropCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317993"><span class="hs-identifier hs-var">maxDrops</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318029"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317991"><span class="hs-identifier hs-var">aggressiveDropPerSteps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317995"><span class="hs-identifier hs-var">aggressiveness</span></a></span><span>
</span><span id="line-203"></span><span>                                </span><span id="local-6989586621680317987"><span class="annot"><span class="annottext">dropCount :: Int
</span><a href="#local-6989586621680317987"><span class="hs-identifier hs-var hs-var">dropCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317990"><span class="hs-identifier hs-var">aggressiveDropCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317995"><span class="hs-identifier hs-var">aggressiveness</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>                            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span>
</span><span id="line-206"></span><span>                                </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span>
</span><span id="line-207"></span><span>                                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span>
</span><span id="line-208"></span><span>                                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topDownByScoreSynthesisIO: prio=%-15s depth=%-5s score=%-10s drops=%-3s %s -&gt; %s&quot;</span></span><span>
</span><span id="line-209"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317998"><span class="hs-identifier hs-var">prio</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680317997"><span class="hs-identifier hs-var">depth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680317996"><span class="hs-identifier hs-var">score</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680317987"><span class="hs-identifier hs-var">dropCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680318024"><span class="hs-identifier hs-var">currentNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>                            </span><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
-&gt; t
-&gt; Float
-&gt; t
-&gt; Maybe Text
-&gt; BackendCtx tag2 v2 x2 t2
-&gt; Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Method.html#topDownByScoreSynthesisIO%27"><span class="hs-identifier hs-var">topDownByScoreSynthesisIO'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pol item.
HeapItem pol item =&gt;
Int -&gt; Heap pol item -&gt; Heap pol item
</span><span class="hs-identifier hs-var">H.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680317987"><span class="hs-identifier hs-var">dropCount</span></a></span><span> </span><span class="annot"><span class="annottext">HeapT
  (Prio
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
  (Val
     pol
     (Float,
      Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t))
</span><a href="#local-6989586621680318002"><span class="hs-identifier hs-var">heapWithSubforest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318029"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621680318028"><span class="hs-identifier hs-var">depthCoeffBase</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680318027"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680318026"><span class="hs-identifier hs-var">scoreKey</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag2 v2 x2 t2
</span><a href="#local-6989586621680318025"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680317999"><span class="hs-identifier hs-var">nextBestScoreNode</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621680318943"><span id="local-6989586621680318944"><span id="local-6989586621680318945"><span id="local-6989586621680318946"><span id="local-6989586621680318947"><span id="local-6989586621680318948"><span class="annot"><a href="NITTA.Synthesis.Method.html#selectSubForestIO"><span class="hs-identifier hs-type">selectSubForestIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisMethodConstraints"><span class="hs-identifier hs-type">SynthesisMethodConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680318944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="NITTA.Model.TargetSystem.html#TargetSystem"><span class="hs-identifier hs-type">TargetSystem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Networks.Bus.html#BusNetwork"><span class="hs-identifier hs-type">BusNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680318943"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318943"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="NITTA.UIBackend.Types.html#BackendCtx"><span class="hs-identifier hs-type">BackendCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318948"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318946"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318945"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span><span>
</span><span id="line-230"></span><span id="selectSubForestIO"><span class="annot"><span class="annottext">selectSubForestIO :: forall tag v x t m ctx.
(SynthesisMethodConstraints tag v x t,
 m ~ TargetSystem (BusNetwork tag v x t) tag v x t,
 ctx ~ SynthesisState m tag v x t) =&gt;
(SynthesisDecision ctx m -&gt; Bool)
-&gt; BackendCtx tag v x t
-&gt; DefTree tag v x t
-&gt; IO [DefTree tag v x t]
</span><a href="NITTA.Synthesis.Method.html#selectSubForestIO"><span class="hs-identifier hs-var hs-var">selectSubForestIO</span></a></span></span><span> </span><span id="local-6989586621680317938"><span class="annot"><span class="annottext">SynthesisDecision ctx m -&gt; Bool
</span><a href="#local-6989586621680317938"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680317937"><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680317937"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680317936"><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680317936"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SynthesisDecision ctx m -&gt; Bool
</span><a href="#local-6989586621680317938"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {tag1} {v1} {x1} {t1} {tag2} {v2} {x2} {t2}.
(UnitTag tag1, Hashable v1, Suffix v1, Val x1, Bounded t1,
 ToJSONKey v1, Show t1, Default t1, Integral t1, ToJSON v1,
 ToJSON t1, ToJSON tag1, Typeable v1, Typeable t1, Ord v1,
 ToString v1, IsString v1) =&gt;
BackendCtx tag2 v2 x2 t2
-&gt; Tree
     (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
     tag1
     v1
     x1
     t1
-&gt; IO
     [Tree
        (TargetSystem (BusNetwork tag1 v1 x1 t1) tag1 v1 x1 t1)
        tag1
        v1
        x1
        t1]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var">positiveSubForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">BackendCtx tag v x t
</span><a href="#local-6989586621680317937"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">DefTree tag v x t
</span><a href="#local-6989586621680317936"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621680318935"><span id="local-6989586621680318936"><span id="local-6989586621680318937"><span id="local-6989586621680318938"><span class="annot"><a href="NITTA.Synthesis.Method.html#bestDecision"><span class="hs-identifier hs-type">bestDecision</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318938"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318937"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318936"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318935"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#DefTree"><span class="hs-identifier hs-type">DefTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318938"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318937"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318936"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680318935"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-233"></span><span id="bestDecision"><span class="annot"><span class="annottext">bestDecision :: forall tag v x t. [DefTree tag v x t] -&gt; Maybe (DefTree tag v x t)
</span><a href="NITTA.Synthesis.Method.html#bestDecision"><span class="hs-identifier hs-var hs-var">bestDecision</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-234"></span><span class="annot"><a href="NITTA.Synthesis.Method.html#bestDecision"><span class="hs-identifier hs-var">bestDecision</span></a></span><span> </span><span id="local-6989586621680317933"><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680317933"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t1 :: * -&gt; *} {a} {t2}.
(Foldable t1, Ord a) =&gt;
(t2 -&gt; a) -&gt; t1 t2 -&gt; t2
</span><a href="NITTA.Utils.Base.html#maximumOn"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefTree tag v x t]
</span><a href="#local-6989586621680317933"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-235"></span></pre></body></html>